<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Spr치va webu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        :root {
            --editor-bg: #1e1e1e;
            --editor-border: rgba(255, 255, 255, 0.1);
        }

        .admin-container {
            max-width: 1800px;
            width: 100%;
            box-sizing: border-box;
            margin: 100px auto 2rem;
            padding: 0 2rem;
            overflow-x: hidden;
        }

        .login-container {
            max-width: 400px;
            margin: 150px auto;
            padding: 2rem;
            background: var(--surface-color);
            border-radius: var(--border-radius);
            border: 1px solid var(--editor-border);
        }

        .admin-header {
            background: linear-gradient(135deg, #1f2937, #111827);
            padding: 1.5rem 2rem;
            border-radius: var(--border-radius);
            margin-bottom: 2rem;
            color: var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-left: 4px solid var(--primary-color);
        }

        /* Explicit Header Navigation Styles */
        #adminPanel header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #0f172a;
            /* Dark sleek background */
            z-index: 10000;
            padding: 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        #adminPanel nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1800px;
            margin: 0 auto;
            padding: 0.75rem 2rem;
        }

        #adminPanel .nav-links {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        #adminPanel .logo {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        #adminPanel .nav-links a {
            color: #e2e8f0;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
            font-size: 0.95rem;
        }

        #adminPanel .nav-links a:hover {
            color: var(--primary-color);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--surface-color);
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--editor-border);
        }

        .data-table th {
            background: rgba(255, 255, 255, 0.05);
            color: var(--primary-color);
            font-weight: 600;
        }

        .data-table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-published {
            background: rgba(34, 197, 94, 0.2);
            color: #86efac;
        }

        .status-draft {
            background: rgba(234, 179, 8, 0.2);
            color: #fde047;
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 0.85rem;
            margin-right: 0.25rem;
            transition: all 0.2s;
        }

        .btn-edit {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
        }

        .btn-delete {
            background: rgba(220, 38, 38, 0.2);
            color: #fca5a5;
        }

        .btn-publish {
            background: rgba(34, 197, 94, 0.2);
            color: #86efac;
        }

        .editor-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
            min-height: 80vh;
        }

        .editor-main,
        .editor-sidebar {
            background: var(--surface-color);
            border-radius: var(--border-radius);
            border: 1px solid var(--editor-border);
            padding: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--editor-border);
            border-radius: 6px;
            color: var(--text-color);
            font-family: inherit;
        }

        .wysiwyg-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--editor-border);
            border-radius: 6px 6px 0 0;
            border-bottom: none;
        }

        .wysiwyg-toolbar button {
            padding: 0.5rem 0.75rem;
            background: transparent;
            border: 1px solid transparent;
            color: var(--text-color);
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .wysiwyg-toolbar button:hover {
            background: rgba(212, 175, 55, 0.2);
            border-color: var(--primary-color);
        }

        .wysiwyg-toolbar button.active {
            background: rgba(212, 175, 55, 0.4);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .wysiwyg-toolbar .divider {
            width: 1px;
            background: var(--editor-border);
            margin: 0 0.5rem;
        }

        .wysiwyg-content {
            min-height: 400px;
            padding: 1rem;
            background: var(--editor-bg);
            border: 1px solid var(--editor-border);
            border-radius: 0 0 6px 6px;
            color: var(--text-color);
            line-height: 1.6;
            outline: none;
            overflow-y: auto;
        }

        .wysiwyg-content:focus {
            border-color: var(--primary-color);
        }

        .highlight-name {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(147, 51, 234, 0.3));
            padding: 0.1rem 0.4rem;
            border-radius: 4px;
            font-weight: 600;
        }

        .highlight-score {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.3), rgba(16, 185, 129, 0.3));
            padding: 0.1rem 0.4rem;
            border-radius: 4px;
            font-weight: 700;
        }

        .wysiwyg-content a {
            color: #60a5fa;
            text-decoration: underline;
            text-underline-offset: 2px;
            cursor: pointer;
        }

        .wysiwyg-content a::after {
            content: ' 游댕';
            font-size: 0.7em;
        }

        .wysiwyg-content a:hover {
            color: #93c5fd;
        }

        .preview-card {
            margin-bottom: 1.5rem;
        }

        .preview-title {
            font-size: 0.85rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.75rem;
        }

        .news-preview {
            background: var(--editor-bg);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--editor-border);
        }

        .preview-image {
            height: 180px;
            background: rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .preview-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-upload {
            border: 2px dashed var(--editor-border);
            border-radius: 6px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .image-upload:hover {
            border-color: var(--primary-color);
            background: rgba(212, 175, 55, 0.05);
        }

        .image-upload.has-image {
            padding: 0;
            border: none;
        }

        .uploaded-thumb {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 6px;
        }

        /* Styles for content blocks in editor */
        .wysiwyg-content .puzzle-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid var(--primary-color);
        }

        .wysiwyg-content .puzzle-section img {
            max-width: 320px;
            margin: 1rem auto;
            display: block;
        }

        .wysiwyg-content .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .wysiwyg-content .card-content {
            padding: 1.5rem;
        }

        #articlePreview .puzzle-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid var(--primary-color);
        }

        #articlePreview .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin: 1rem 0;
        }

        #articlePreview .card-content {
            padding: 1.5rem;
        }

        .panel-section {
            margin-top: 1.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 6px;
            border: 1px solid var(--editor-border);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .game-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0.75rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 4px;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            cursor: grab;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .game-item:hover {
            background: rgba(255, 255, 255, 0.06);
        }

        .game-item.dragging {
            opacity: 0.5;
            background: rgba(212, 175, 55, 0.2);
            border: 1px dashed var(--primary-color);
        }

        .game-item.drag-over {
            border-top: 2px solid var(--primary-color);
        }

        .game-item .drag-handle {
            cursor: grab;
            color: var(--text-muted);
            margin-right: 0.75rem;
        }

        .game-item .game-inputs {
            display: flex;
            gap: 0.5rem;
            flex: 1;
        }

        .game-item .game-title-input {
            flex: 2;
            padding: 0.3rem 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--editor-border);
            border-radius: 4px;
            color: var(--text-color);
            font-size: 0.85rem;
        }

        .game-item .game-id-input {
            flex: 1;
            padding: 0.3rem 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--editor-border);
            border-radius: 4px;
            color: var(--text-color);
            font-size: 0.85rem;
            max-width: 120px;
        }

        .game-item .game-actions {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            margin-left: 0.5rem;
        }

        .game-item .team-badge {
            font-size: 0.75rem;
            padding: 0.15rem 0.5rem;
            border-radius: 3px;
            margin-left: 0.5rem;
        }

        .team-checkbox-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .team-checkbox {
            display: flex;
            align-items: center;
            padding: 0.4rem 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .team-checkbox:hover {
            background: rgba(212, 175, 55, 0.1);
        }

        .team-checkbox input {
            margin-right: 0.5rem;
        }

        .team-checkbox.checked {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid var(--primary-color);
        }

        .add-team-input {
            display: flex;
            gap: 0.5rem;
        }

        .add-team-input input {
            flex: 1;
            padding: 0.5rem;
            font-size: 0.85rem;
        }

        .add-team-input button {
            padding: 0.5rem 0.75rem;
        }

        .admin-nav {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--editor-border);
            padding-bottom: 1rem;
        }

        .nav-tab {
            padding: 0.6rem 1.2rem;
            cursor: pointer;
            border-radius: 6px;
            color: var(--text-muted);
            transition: all 0.2s;
            font-size: 0.95rem;
        }

        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-color);
        }

        .nav-tab.active {
            background: var(--primary-color);
            color: var(--secondary-color);
            font-weight: 600;
        }

        .btn-primary {
            background: var(--primary-color);
            color: var(--secondary-color);
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-color);
            padding: 0.75rem 1.5rem;
            border: 1px solid var(--editor-border);
            border-radius: 6px;
            cursor: pointer;
        }

        .btn-small {
            padding: 0.4rem 0.8rem;
            font-size: 0.85rem;
        }

        .hidden {
            display: none !important;
        }

        .alert {
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 1rem;
        }

        .alert-error {
            background: rgba(220, 38, 38, 0.1);
            color: #fca5a5;
        }

        .alert-success {
            background: rgba(34, 197, 94, 0.1);
            color: #86efac;
        }

        /* Tablet and smaller desktop */
        @media (max-width: 1200px) {
            .editor-layout {
                grid-template-columns: 1fr;
            }

            .editor-sidebar {
                order: 1;
                /* Put sidebar AFTER content on mobile */
                margin-top: 1rem;
            }
        }

        /* Tablet */
        @media (max-width: 992px) {
            .admin-container {
                padding: 1rem;
            }

            .admin-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
                padding: 1rem;
            }

            .admin-header h1 {
                font-size: 1.25rem !important;
            }

            .admin-nav {
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                gap: 0.25rem;
                padding-bottom: 0.5rem;
            }

            .admin-nav::-webkit-scrollbar {
                display: none;
            }

            .nav-tab {
                white-space: nowrap;
                flex-shrink: 0;
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
            }

            .nav-tab i {
                display: none;
            }
        }

        /* Mobile */
        @media (max-width: 768px) {
            header nav {
                flex-direction: column;
                gap: 0.5rem;
            }

            header .nav-links {
                gap: 1rem;
                flex-direction: row;
                justify-content: center;
                flex-wrap: wrap;
            }

            .admin-header {
                padding: 0.75rem;
                border-radius: 8px;
                margin-bottom: 1rem;
            }

            .admin-header h1 {
                font-size: 1rem !important;
            }

            .admin-header p {
                font-size: 0.75rem !important;
            }

            header .nav-links a {
                padding: 0.5rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 4px;
            }

            .nav-tab {
                padding: 0.4rem 0.6rem;
                font-size: 0.7rem;
            }

            .form-group label {
                font-size: 0.8rem;
            }

            .form-group input,
            .form-group select,
            .form-group textarea {
                font-size: 0.85rem;
                padding: 0.5rem;
            }

            .btn-primary,
            .btn-secondary {
                font-size: 0.85rem;
                padding: 0.6rem 1rem;
            }

            .data-table {
                display: block;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .data-table th,
            .data-table td {
                padding: 0.4rem 0.3rem;
                font-size: 0.7rem;
            }

            /* Title column can wrap */
            .data-table td:nth-child(2) {
                white-space: normal;
                word-break: break-word;
                max-width: 150px;
            }

            /* Other columns stay compact */
            .data-table td:nth-child(1),
            .data-table td:nth-child(5),
            .data-table td:nth-child(6) {
                white-space: nowrap;
            }

            .wysiwyg-toolbar {
                gap: 0.25rem;
                padding: 0.5rem;
            }

            .wysiwyg-toolbar button {
                padding: 0.4rem 0.5rem;
                font-size: 0.7rem;
            }

            .wysiwyg-content {
                min-height: 200px;
                font-size: 0.9rem;
            }

            .preview-card {
                margin-bottom: 0.75rem;
            }

            .panel-section {
                padding: 0.75rem;
                margin-bottom: 0.75rem;
            }

            .panel-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
        }

        /* Small mobile */
        @media (max-width: 480px) {
            body {
                font-size: 14px;
            }

            .admin-container {
                padding: 0.5rem;
            }

            .admin-header h1 {
                font-size: 0.9rem !important;
            }

            .nav-tab {
                padding: 0.35rem 0.5rem;
                font-size: 0.65rem;
            }

            .editor-sidebar {
                padding: 0.75rem;
            }

            .status-text {
                display: none;
            }

            .hide-mobile {
                display: none !important;
            }
        }

        /* Toast Notifications */
        #alertContainer {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            width: auto;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        }

        #alertContainer .alert {
            pointer-events: auto;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            animation: slideIn 0.3s ease-out;
            margin: 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Toggle Switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #333;
            transition: .4s;
            border-radius: 20px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 14px;
            width: 14px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: var(--primary-color);
        }

        input:checked+.slider:before {
            transform: translateX(20px);
        }
    </style>
</head>

<body>
    <!-- LOGIN -->
    <div id="loginPage" class="hidden">
        <div class="login-container">
            <h1 style="text-align: center; margin-bottom: 2rem;">
                <i class="fa-solid fa-chess-knight" style="color: var(--primary-color);"></i><br>Admin Panel
            </h1>
            <div id="loginError"></div>
            <form id="loginForm">
                <div class="form-group"><label>U쬴vatelsk칠 jm칠no</label><input type="text" id="username" required></div>
                <div class="form-group"><label>Heslo</label>
                    <div style="position: relative;">
                        <input type="password" id="password" required style="padding-right: 40px;">
                        <i class="fa-solid fa-eye" id="togglePassword"
                            style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; color: var(--text-muted);"></i>
                    </div>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%">P콏ihl치sit se</button>
            </form>
        </div>
    </div>

    <!-- ADMIN PANEL -->
    <div id="adminPanel" class="hidden">
        <header>
            <div class="container">
                <nav>
                    <a href="index.html" class="logo"><i class="fa-solid fa-chess-knight"></i> TJ Bi쬿terie - Admin</a>
                    <ul class="nav-links">
                        <li style="display: flex; align-items: center; margin-right: 1rem;">
                            <label class="switch" style="margin-bottom: 0;">
                                <input type="checkbox" id="maintenanceToggle" onchange="toggleMaintenance()">
                                <span class="slider round"></span>
                            </label>
                            <span style="font-size: 0.8rem; margin-left: 0.5rem; color: #aaa;">칔dr쬭a</span>
                        </li>
                        <li><a href="index.html" target="_blank"><i class="fa-solid fa-home"></i> Web</a></li>
                        <li><a href="#" onclick="logout()" style="color: #fca5a5;"><i
                                    class="fa-solid fa-sign-out-alt"></i> Odhl치sit</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div class="admin-container">
            <div class="admin-header">
                <div>
                    <h1><i class="fa-solid fa-cogs"></i> Spr치va webu</h1>
                    <p style="margin: 0.25rem 0 0 0; font-size: 0.9rem; opacity: 0.8; visibility: visible !important;"
                        id="userInfo"></p>
                </div>
            </div>

            <div class="admin-nav">
                <div class="nav-tab active" onclick="switchTab('dashboard')"><i class="fa-solid fa-list"></i> P콏ehled
                </div>
                <div class="nav-tab" onclick="switchTab('editor'); resetEditor();"><i class="fa-solid fa-plus"></i> Nov치
                    novinka</div>
                <div class="nav-tab" onclick="switchTab('members')" style="display: none;"><i
                        class="fa-solid fa-address-book"></i> 캛lenov칠
                </div>
                <div class="nav-tab hidden" id="usersTab" onclick="switchTab('users')"><i class="fa-solid fa-users"></i>
                    U쬴vatel칠</div>
                <div class="nav-tab" id="messagesTab" onclick="switchTab('messages')"><i
                        class="fa-solid fa-comments"></i>
                    Vzkazovn칤k</div>
                <div class="nav-tab" id="blicakTab" onclick="switchTab('blicak')"><i class="fa-solid fa-bolt"></i>
                    V치no캜n칤 blesk</div>
                <div class="nav-tab" id="competitionsTab" onclick="switchTab('competitions')"><i
                        class="fa-solid fa-table"></i>
                    Tabulky dru쬽tva</div>
                <div class="nav-tab" id="galleryTab" onclick="switchTab('gallery')" style="display: none;"><i
                        class="fa-regular fa-images"></i>
                    Galerie</div>
            </div>

            <div id="alertContainer"></div>

            <!-- DASHBOARD -->
            <div id="dashboardView">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2 style="margin: 0;">Seznam novinek</h2>
                    <button class="btn-primary" onclick="switchTab('editor'); resetEditor();"><i
                            class="fa-solid fa-plus"></i> Nov치
                        novinka</button>
                </div>
                <table class="data-table" id="newsTable">
                    <thead>
                        <tr>
                            <th>Datum</th>
                            <th>N치zev</th>
                            <th class="hide-mobile">Kategorie</th>
                            <th class="hide-mobile">Autor</th>
                            <th class="hide-mobile">Stav</th>
                            <th>Akce</th>
                        </tr>
                    </thead>
                    <tbody id="newsTableBody"></tbody>
                </table>
            </div>

            <!-- EDITOR -->
            <div id="editorView" class="hidden">
                <div class="editor-layout">
                    <!-- Main Editor (70%) -->
                    <div class="editor-main">
                        <h2 style="margin-top: 0;" id="editorTitle">Nov치 novinka</h2>
                        <input type="hidden" id="editNewsId">

                        <div class="form-group">
                            <label>Nadpis 캜l치nku *</label>
                            <input type="text" id="newsTitle" placeholder="Zadejte nadpis..." oninput="updatePreview()">
                        </div>

                        <!-- WYSIWYG Editor -->
                        <div class="form-group">
                            <label>Obsah 캜l치nku *</label>
                            <div class="wysiwyg-toolbar" style="flex-wrap: wrap;">
                                <!-- Row 1: Formatting -->
                                <button type="button" id="btnBold" onclick="formatText('bold')"
                                    title="Tu캜n캩 (Ctrl+B)"><i class="fa-solid fa-bold"></i></button>
                                <button type="button" id="btnItalic" onclick="formatText('italic')"
                                    title="Kurz칤va (Ctrl+I)"><i class="fa-solid fa-italic"></i></button>
                                <button type="button" id="btnUnderline" onclick="formatText('underline')"
                                    title="Podtr쬰n칤 (Ctrl+U)"><i class="fa-solid fa-underline"></i></button>
                                <div class="divider"></div>
                                <!-- Gallery Management Section -->
                                <div id="gallery-section" class="content-section" style="display: none;">
                                    <div class="header-actions">
                                        <h2><i class="fa-regular fa-images"></i> Spr치va Galerie</h2>
                                        <button class="primary-btn"
                                            onclick="document.getElementById('imageUploadInput').click()">
                                            <i class="fa-solid fa-cloud-arrow-up"></i> Nahr치t fotky
                                        </button>
                                        <input type="file" id="imageUploadInput" multiple accept="image/*"
                                            style="display: none;" onchange="handleAdminGalleryUpload(this)">
                                    </div>

                                    <div class="card" style="padding: 0;">
                                        <div style="overflow-x: auto;">
                                            <table class="data-table">
                                                <thead>
                                                    <tr>
                                                        <th>N치hled</th>
                                                        <th>N치zev</th>
                                                        <th>Datum nahr치n칤</th>
                                                        <th>Akce</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="galleryTableBody">
                                                    <tr>
                                                        <td colspan="4" style="text-align: center;">Na캜칤t치m...</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <!-- Settings Section -->>
                                    <!-- Heading buttons -->
                                    <div
                                        style="display: flex; gap: 2px; background: rgba(255,255,255,0.05); border-radius: 4px; padding: 2px;">
                                        <button type="button" id="headingP" onclick="applyHeading('p')"
                                            title="Norm치ln칤 text"
                                            style="padding: 0.25rem 0.5rem; font-size: 0.7rem; font-weight: 600; border-radius: 3px; min-width: 28px;">P</button>
                                        <button type="button" id="headingH1" onclick="applyHeading('h1')"
                                            title="Nadpis 1"
                                            style="padding: 0.25rem 0.5rem; font-size: 0.7rem; font-weight: 700; border-radius: 3px; min-width: 28px;">H1</button>
                                        <button type="button" id="headingH2" onclick="applyHeading('h2')"
                                            title="Nadpis 2"
                                            style="padding: 0.25rem 0.5rem; font-size: 0.7rem; font-weight: 600; border-radius: 3px; min-width: 28px;">H2</button>
                                        <button type="button" id="headingH3" onclick="applyHeading('h3')"
                                            title="Nadpis 3"
                                            style="padding: 0.25rem 0.5rem; font-size: 0.7rem; font-weight: 500; border-radius: 3px; min-width: 28px;">H3</button>
                                    </div>
                                    <div class="divider"></div>
                                    <button type="button" onclick="insertLink()" title="Odkaz"><i
                                            class="fa-solid fa-link"></i></button>
                                    <button type="button" onclick="toggleSource()" title="HTML" id="btnSource"><i
                                            class="fa-solid fa-code"></i></button>

                                    <!-- Row 2: Highlights and blocks (will wrap on smaller screens) -->
                                    <div class="divider" style="height: 0; width: 100%; margin: 0.25rem 0;"></div>
                                    <button type="button" id="btnHighlightName" onmousedown="event.preventDefault()"
                                        onclick="insertHighlight('name')" title="Zv칳raznit jm칠no"
                                        style="color: #60a5fa;"><i class="fa-solid fa-user"></i> Jm칠no</button>
                                    <button type="button" id="btnHighlightScore" onmousedown="event.preventDefault()"
                                        onclick="insertHighlight('score')" title="Zv칳raznit sk칩re"
                                        style="color: #4ade80;"><i class="fa-solid fa-trophy"></i> Sk칩re</button>
                                    <div class="divider"></div>
                                    <button type="button" onclick="insertIntroBlock()" title="Puzzle blok"
                                        style="color: #fbbf24;"><i class="fa-solid fa-lightbulb"></i></button>
                                    <button type="button" onclick="insertImage()" title="Obr치zek"
                                        style="color: #f472b6;"><i class="fa-solid fa-image"></i></button>
                                    <button type="button" onclick="insertCollapsibleBlock()" title="Rozbalovac칤 sekce"
                                        style="color: #8b5cf6;"><i class="fa-solid fa-layer-group"></i></button>
                                </div>
                                <div class="wysiwyg-content" id="articleContent" contenteditable="true"
                                    oninput="updatePreview()"></div>
                                <textarea id="articleSource" class="wysiwyg-content hidden"
                                    oninput="updateContentFromSource()"></textarea>
                            </div>

                            <!-- Games Panel -->
                            <div class="panel-section">
                                <div class="panel-header">
                                    <label style="margin: 0;"><i class="fa-solid fa-chess-board"></i> P콏ehr치va캜
                                        parti칤</label>
                                </div>

                                <div class="form-group" id="gamesInputPanel">
                                    <div
                                        style="background: rgba(255, 255, 255, 0.05); padding: 0.75rem; border-radius: 8px; margin-bottom: 1rem;">
                                        <h4
                                            style="margin-top: 0; margin-bottom: 0.5rem; color: var(--primary-color); font-size: 0.85rem;">
                                            P콏idat partii</h4>
                                        <div style="display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap;">
                                            <input type="text" id="gameTitle" placeholder="Kdo s k칳m"
                                                style="flex: 1; min-width: 120px; max-width: 180px; font-size: 0.8rem; padding: 0.4rem;">
                                            <input type="text" id="gameId" placeholder="Chess.com ID"
                                                style="width: 120px; font-size: 0.8rem; padding: 0.4rem;">
                                            <label
                                                style="display: flex; align-items: center; gap: 0.3rem; cursor: pointer; font-size: 0.75rem; white-space: nowrap;">
                                                <input type="checkbox" id="gameCommented"
                                                    style="width: auto; margin: 0;">
                                                Koment.
                                            </label>
                                            <button type="button" class="btn-primary btn-small" onclick="addGame()"
                                                style="padding: 0.4rem 0.6rem; font-size: 0.75rem; white-space: nowrap;">
                                                <i class="fa-solid fa-plus"></i> P콏idat
                                            </button>
                                        </div>
                                    </div>

                                    <div
                                        style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                                        <h4 style="margin-top: 0; color: var(--primary-color);">P콏idat nadpis
                                            (odd캩lova캜)
                                        </h4>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <input type="text" id="headerTitle" placeholder="Nap콏. A t칳m, B t칳m...">
                                            <button type="button" class="btn-secondary btn-small" onclick="addHeader()">
                                                <i class="fa-solid fa-heading"></i> P콏idat
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div id="gamesList" style="margin-top: 1rem;"></div>
                            </div>

                            <!-- Gallery Panel -->
                            <div class="panel-section">
                                <div class="panel-header">
                                    <label style="margin: 0;"><i class="fa-solid fa-images"></i> Galerie</label>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button type="button" class="btn-secondary btn-small"
                                            onclick="document.getElementById('galleryInput').click()"><i
                                                class="fa-solid fa-upload"></i> Nahr치t</button>
                                        <button type="button" class="btn-secondary btn-small"
                                            onclick="toggleGalleryUrlInput()"><i class="fa-solid fa-link"></i>
                                            URL</button>
                                    </div>
                                    <input type="file" id="galleryInput" accept="image/*" multiple
                                        style="display: none;" onchange="addGalleryImages(event)">
                                </div>
                                <div id="galleryUrlInput" class="hidden" style="margin-bottom: 0.75rem;">
                                    <div style="display: flex; gap: 0.5rem;">
                                        <input type="text" id="galleryImageUrl" placeholder="URL obr치zku (https://...)"
                                            style="flex: 1; font-size: 0.85rem;">
                                        <button type="button" class="btn-primary btn-small"
                                            onclick="addGalleryFromUrl()">P콏idat</button>
                                    </div>
                                </div>
                                <div id="galleryPreview" style="display: flex; flex-wrap: wrap; gap: 0.5rem;"></div>
                            </div>

                            <div style="margin-top: 2rem; display: flex; gap: 1rem;">
                                <button class="btn-primary" onclick="saveNews()"><i class="fa-solid fa-save"></i>
                                    Ulo쬴t</button>
                                <button class="btn-secondary" onclick="switchTab('dashboard')">Zru코it</button>
                            </div>
                        </div>

                        <!-- Sidebar (30%) -->
                        <div class="editor-sidebar">
                            <!-- SECTION 1: Publikace (collapsible) -->
                            <div id="publikaceSection"
                                style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <div onclick="toggleSidebarSection('publikace')"
                                    style="display: flex; align-items: center; justify-content: space-between; gap: 0.5rem; margin-bottom: 0.75rem; color: var(--primary-color); cursor: pointer;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fa-solid fa-paper-plane"></i>
                                        <span style="font-weight: 600;">Publikace</span>
                                    </div>
                                    <i class="fa-solid fa-chevron-down" id="publikaceIcon"
                                        style="font-size: 0.7rem; transition: transform 0.2s;"></i>
                                </div>
                                <div id="publikaceContent">

                                    <div class="form-group" style="margin-bottom: 0.75rem;">
                                        <label style="font-size: 0.8rem;">Kategorie</label>
                                        <select id="newsCategory" onchange="updatePreview()"
                                            style="font-size: 0.85rem;">
                                            <option value="Sout캩쬰 dru쬽tev">Sout캩쬰 dru쬽tev</option>
                                            <option value="Odd칤lov칳 p콏ebor">Odd칤lov칳 p콏ebor</option>
                                            <option value="Ml치de">Ml치de</option>
                                            <option value="O n치s">O n치s</option>
                                        </select>
                                    </div>

                                    <div class="form-group" style="margin-bottom: 0.75rem;">
                                        <label style="font-size: 0.8rem;">Datum</label>
                                        <input type="date" id="newsDate" oninput="updatePreview()"
                                            style="font-size: 0.85rem;">
                                    </div>

                                    <div class="form-group" style="margin-bottom: 0.75rem;">
                                        <label style="font-size: 0.8rem;">Kr치tk칳 popis</label>
                                        <textarea id="newsExcerpt" rows="2" placeholder="Zobraz칤 se na kart캩..."
                                            oninput="updatePreview()" style="font-size: 0.85rem;"></textarea>
                                    </div>

                                    <label
                                        style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-size: 0.85rem;">
                                        <input type="checkbox" id="publishCheck" style="width: auto;">
                                        <span>Publikovat ihned</span>
                                    </label>

                                    <button type="button" class="btn-primary" onclick="saveNews()"
                                        style="width: 100%; margin-top: 1rem; justify-content: center;">
                                        <i class="fa-solid fa-save"></i> Ulo쬴t
                                    </button>
                                </div><!-- end publikaceContent -->
                            </div><!-- end publikaceSection -->

                            <!-- SECTION 2: Obr치zek -->
                            <div
                                style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <div
                                    style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: #f472b6;">
                                    <i class="fa-solid fa-image"></i>
                                    <span style="font-weight: 600;">N치hledov칳 obr치zek</span>
                                </div>

                                <div class="image-upload" id="uploadArea"
                                    onclick="document.getElementById('imageInput').click()"
                                    style="height: 120px; margin-bottom: 0.5rem; position: relative;">
                                    <div id="uploadPlaceholder">
                                        <i class="fa-solid fa-cloud-upload-alt"
                                            style="font-size: 1.2rem; color: var(--primary-color);"></i>
                                        <p style="margin: 0.3rem 0 0 0; font-size: 0.75rem;">Klikn캩te pro nahr치n칤
                                        </p>
                                    </div>
                                    <img id="uploadedImage" class="uploaded-thumb" style="display: none;">
                                    <button type="button" id="removeImageBtn"
                                        onclick="event.stopPropagation(); removeImage();"
                                        style="display: none; position: absolute; top: 5px; right: 5px; background: rgba(0,0,0,0.7); border: none; color: #f87171; padding: 0.3rem 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.7rem;">
                                        <i class="fa-solid fa-times"></i>
                                    </button>
                                </div>
                                <input type="file" id="imageInput" accept="image/*" style="display: none;"
                                    onchange="handleImageUpload(event)">

                                <div id="imageUrlWrapper" style="display: flex; gap: 0.5rem; align-items: center;">
                                    <input type="text" id="imageUrl" placeholder="nebo URL obr치zku"
                                        style="font-size: 0.8rem; flex: 1;">
                                    <button type="button" class="btn-secondary btn-small" onclick="handleImageUrl()"
                                        style="padding: 0.4rem 0.6rem; font-size: 0.75rem;">Pou쮂셦</button>
                                </div>

                                <!-- Crop position selector -->
                                <div id="cropPositionWrapper" style="display: none; margin-top: 0.8rem;">
                                    <label
                                        style="font-size: 0.75rem; color: var(--text-muted); display: flex; justify-content: space-between; margin-bottom: 0.4rem;">
                                        <span>Pozice o콏ezu (v칳코ka):</span>
                                        <span id="cropValueLabel" style="color: var(--primary-color);">50%</span>
                                    </label>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="font-size: 0.7rem; color: var(--text-muted);">Horn칤</span>
                                        <input type="range" id="cropSlider" min="0" max="100" value="50" step="1"
                                            oninput="updateCropFromSlider(this.value)"
                                            style="flex: 1; cursor: pointer;">
                                        <span style="font-size: 0.7rem; color: var(--text-muted);">Doln칤</span>
                                    </div>
                                </div> <button type="button" onclick="rotateImage()"
                                    style="width: 100%; margin-top: 0.5rem; padding: 0.3rem; background: rgba(255, 255, 255, 0.05); border: 1px solid var(--editor-border); color: var(--text-color); border-radius: 4px; cursor: pointer; font-size: 0.75rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                                    <i class="fa-solid fa-rotate-right"></i> Oto캜it o 90춿
                                </button>
                            </div>
                        </div>

                        <!-- SECTION 3: N치hledy -->
                        <div>
                            <div
                                style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: #60a5fa;">
                                <i class="fa-solid fa-eye"></i>
                                <span style="font-weight: 600;">N치hledy</span>
                            </div>

                            <!-- Card preview -->
                            <div class="preview-card" style="margin-bottom: 0.75rem;">
                                <div class="preview-title" style="font-size: 0.75rem; padding: 0.5rem;">Karta</div>
                                <div class="news-preview"
                                    style="width: 100%; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; overflow: hidden; background: #1a1a1a;">
                                    <div class="preview-image" id="previewImage"
                                        style="height: 120px; text-align: center; background: #000; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                                        <i class="fa-solid fa-image"
                                            style="font-size: 1.5rem; color: var(--text-muted);"></i>
                                    </div>
                                    <div class="card-content" style="padding: 0.75rem;">
                                        <span class="card-category" id="previewCategory"
                                            style="font-size: 0.6rem;">Kategorie</span>
                                        <span class="card-date" id="previewDate"
                                            style="font-size: 0.55rem;">Datum</span>
                                        <h3 class="card-title" id="previewTitle"
                                            style="font-size: 0.8rem; margin: 0.3rem 0;">Nadpis</h3>
                                        <p class="card-excerpt" id="previewExcerpt"
                                            style="font-size: 0.7rem; color: var(--text-muted);">Popis...</p>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- USERS -->
    <!-- MEMBERS -->
    <div id="membersView" class="hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h2 style="margin: 0;">Seznam 캜len콢</h2>
            <button class="btn-primary" onclick="openMemberModal()"><i class="fa-solid fa-user-plus"></i>
                Nov칳
                캜len</button>
        </div>

        <table class="data-table">
            <thead>
                <tr>
                    <th>Jm칠no</th>
                    <th>ELO</th>
                    <th>Titul</th>
                    <th>Narozen칤</th>
                    <th>Role</th>
                    <th>Akce</th>
                </tr>
            </thead>
            <tbody id="membersTableBody"></tbody>
        </table>
    </div>

    <div id="usersView" class="hidden">
        <div class="editor-layout">
            <div>
                <h2>Seznam u쬴vatel콢</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Akce</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody"></tbody>
                </table>
            </div>
            <div class="editor-sidebar">
                <h3>P콏idat u쬴vatele</h3>
                <div class="form-group"><label>Username</label><input type="text" id="newUsername"></div>
                <div class="form-group"><label>Email</label><input type="email" id="newEmail"></div>
                <div class="form-group"><label>Heslo</label><input type="password" id="newPassword"></div>
                <div class="form-group"><label>Role</label><select id="newRole">
                        <option value="admin">Admin</option>
                        <option value="superadmin">Superadmin</option>
                    </select></div>
                <button class="btn-primary" onclick="createUser()">Vytvo콏it</button>
            </div>
        </div>
    </div>

    <div id="messagesView" class="hidden">
        <h2><i class="fa-solid fa-comments"></i> Spr치va vzkazovn칤ku</h2>
        <p style="color: var(--text-muted); margin-bottom: 1.5rem;">Zde m콢쬰te mazat nevhodn칠 p콏칤sp캩vky ze
            vzkazovn칤ku.</p>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Autor</th>
                    <th>Obsah</th>
                    <th>Datum</th>
                    <th>Akce</th>
                </tr>
            </thead>
            <tbody id="messagesTableBody"></tbody>
        </table>
        <div id="noMessagesInfo" style="text-align: center; padding: 2rem; color: var(--text-muted); display: none;">
            콯치dn칠 vzkazy k zobrazen칤.
        </div>
    </div>

    <!-- Blicak Registrations View -->
    <div id="blicakView" class="hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h2 style="margin: 0;"><i class="fa-solid fa-bolt"></i> Registrace - V치no캜n칤 blesk</h2>
            <button class="btn-primary" onclick="loadBlicakRegistrations()"><i class="fa-solid fa-sync"></i>
                Obnovit</button>
        </div>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Jm칠no</th>
                    <th>Odd칤l</th>
                    <th>LOK</th>
                    <th>Ro캜n칤k</th>
                    <th>캛as registrace</th>
                </tr>
            </thead>
            <tbody id="blicakTableBody"></tbody>
        </table>
        <div id="noBlicakInfo" style="text-align: center; padding: 2rem; color: var(--text-muted); display: none;">
            콯치dn칠 registrace.
        </div>
    </div>

    <!-- Competitions View -->
    <div id="competitionsView" class="hidden">
        <div class="card"
            style="margin-bottom: 2rem; padding: 1.5rem; background: linear-gradient(135deg, var(--card-bg), rgba(59, 130, 246, 0.1)); border-left: 4px solid #3b82f6;">
            <div
                style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                <div style="width: 100%;">
                    <h3 style="margin: 0 0 0.5rem 0; color: #3b82f6;"><i class="fa-solid fa-table"></i>
                        Tabulky
                        dru쬽tva</h3>
                    <p style="margin: 0; color: var(--text-muted); font-size: 0.9rem;">Spr치va zdroj콢 dat pro
                        sout캩쬰. Zm캩ny se projev칤 po kliknut칤 na "Aktualizovat tabulky".</p>

                    <div style="display: flex; justify-content: flex-end; margin-top: 1rem;">
                        <button class="btn-secondary" onclick="updateStandings()" id="updateStandingsBtn">
                            <i class="fa-solid fa-sync"></i> Aktualizovat tabulky
                        </button>
                    </div>

                    <div id="competitionsList" style="margin-top: 1rem;"></div>
                </div>

            </div>
            <div id="standingsResult" style="margin-top: 1rem; display: none;"></div>
        </div>
    </div>

    <!-- Gallery View -->
    <div id="galleryView" class="hidden">
        <div class="header-actions">
            <h2><i class="fa-regular fa-images"></i> Spr치va Galerie</h2>
            <button onclick="document.getElementById('galleryInput').click()" class="btn btn-primary">
                <i class="fa-solid fa-cloud-arrow-up"></i> Nahr치t fotky
            </button>
            <button onclick="triggerMigration()" class="btn btn-warning" style="margin-left: 10px;">
                <i class="fa-solid fa-wrench"></i> Opravit DB
            </button>
            <input type="file" id="galleryInput" multiple accept="image/*" style="display: none;"
                onchange="handleAdminGalleryUpload(this)">
        </div>


        <div class="card" style="padding: 0;">
            <div style="overflow-x: auto;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>N치hled</th>
                            <th>N치zev</th>
                            <th>Ve콏ejn치</th>
                            <th>Datum nahr치n칤</th>
                            <th>Akce</th>
                        </tr>
                    </thead>
                    <tbody id="galleryTableBody">
                        <tr>
                            <td colspan="5" style="text-align: center;">Na캜칤t치m...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    </div>
    </div>

    <!-- Member Modal -->
    <div id="memberModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="width: 500px;">
            <h2 id="memberModalTitle" style="margin-top: 0;">Nov칳 캜len</h2>
            <input type="hidden" id="memberId">
            <div class="form-group">
                <label>Jm칠no *</label>
                <input type="text" id="memberFirstName" placeholder="Jan">
            </div>
            <div class="form-group">
                <label>P콏칤jmen칤 *</label>
                <input type="text" id="memberLastName" placeholder="Nov치k">
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div class="form-group">
                    <label>ELO</label>
                    <input type="number" id="memberElo">
                </div>
                <div class="form-group">
                    <label>Titul</label>
                    <input type="text" id="memberTitle" placeholder="Nap콏. FM">
                </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div class="form-group">
                    <label>Rok narozen칤</label>
                    <input type="number" id="memberBirthYear">
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <input type="text" id="memberRole" placeholder="Nap콏. P콏edseda">
                </div>
            </div>
            <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1rem;">
                <button class="btn-secondary" onclick="closeMemberModal()">Zru코it</button>
                <button class="btn-primary" onclick="saveMember()">Ulo쬴t</button>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script>
        // Admin Panel Logic - use API_URL from config.js
        let authToken = null;
        let currentUser = null;
        let uploadedImageData = null;
        let games = [];
        let teams = ['A t칳m', 'B t칳m']; // Default teams
        let galleryImages = [];

        // Init
        window.addEventListener('DOMContentLoaded', () => {
            authToken = localStorage.getItem('authToken');
            if (authToken) {
                verifyToken();
                checkMaintenance();
            } else showLogin();

            // Editor Enter Key Handler - Clean formatting on new line
            const editor = document.getElementById('articleContent');
            if (editor) {
                // Ensure paragraphs are used for new lines
                document.execCommand('defaultParagraphSeparator', false, 'p');

                editor.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        const sel = window.getSelection();
                        if (!sel.rangeCount) return;

                        // Check if we are inside a highlight
                        let node = sel.anchorNode;
                        if (node.nodeType === 3) node = node.parentNode;

                        if (node.classList && (node.classList.contains('highlight-name') || node.classList.contains('highlight-score'))) {
                            e.preventDefault(); // Stop default browser behavior (which might be just <br> in span)

                            // Force a paragraph break
                            // This splits the block: <p><span class="h">...</span></p> <p><span class="h">...</span></p>
                            document.execCommand('insertParagraph');

                            // Now clean the style on the NEW line
                            // The cursor should be in the new paragraph now

                            // We need to wait a tick for the DOM to settle? execCommand is usually synchronous but let's be safe cleaning up
                            // actually execCommand IS synchronous.

                            const newSel = window.getSelection();
                            let newNode = newSel.anchorNode;
                            if (newNode.nodeType === 3) newNode = newNode.parentNode;

                            // Find the highlight span in this new block and unwrap/clear it
                            // We might be inside the span in the new paragraph
                            if (newNode.classList && (newNode.classList.contains('highlight-name') || newNode.classList.contains('highlight-score'))) {
                                // We are inside the span in the new line.
                                // Remove class to make it plain text
                                newNode.className = '';
                                // Remove ZWS if present
                                if (newNode.innerHTML.includes('\u200B')) {
                                    newNode.innerHTML = newNode.innerHTML.replace(/\u200B/g, '');
                                }
                                // If the span is now empty/useless, we might want to unwrap it entirely, 
                                // but removing class is enough to visually "reset" it.

                                // However, often we want to remove the span tag nicely.
                                // document.execCommand('removeFormat') might be cleaner?
                                // Let's stick to removing class as it's targeted.
                            }

                            checkToolbarState();
                        } else {
                            // Normal Enter functionality - verify clean state on next tick if needed
                        }
                    }
                });
            }
        });

        async function checkMaintenance() {
            try {
                const res = await fetch(`${API_URL}/settings`, { headers: { 'Authorization': `Bearer ${authToken}` } });
                const settings = await res.json();
                document.getElementById('maintenanceToggle').checked = settings.maintenance_mode === 'true';
            } catch (e) { console.error(e); }
        }

        async function toggleMaintenance() {
            const toggle = document.getElementById('maintenanceToggle');
            const value = toggle.checked;
            try {
                const res = await fetch(`${API_URL}/settings`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                    body: JSON.stringify({ key: 'maintenance_mode', value: value })
                });
                if (res.ok) {
                    showAlert(value ? 'Re쬴m 칰dr쬭y ZAPNUT' : 'Re쬴m 칰dr쬭y VYPNUT', value ? 'success' : 'success');
                } else {
                    toggle.checked = !value; // Revert on error
                    showAlert('Chyba p콏i zm캩n캩 nastaven칤', 'error');
                }
            } catch (e) {
                toggle.checked = !value;
                showAlert('Chyba spojen칤', 'error');
            }
        }

        function showLogin() {
            document.getElementById('loginPage').classList.remove('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
        }

        function showAdmin() {
            document.getElementById('loginPage').classList.add('hidden');
            document.getElementById('adminPanel').classList.remove('hidden');

            // Show tabs based on role
            if (['admin', 'superadmin'].includes(currentUser.role)) {
                const galleryBtn = document.getElementById('galleryTab');
                if (galleryBtn) galleryBtn.style.display = 'inline-block';

                // Users tab
                const usersBtn = document.getElementById('usersTab');
                if (usersBtn) {
                    usersBtn.classList.remove('hidden');
                    usersBtn.style.display = 'inline-block';
                }

                // Settings tab (if implementation exists later)
                // const settingsBtn = document.getElementById('settingsTab');
                // if (settingsBtn) settingsBtn.style.display = 'inline-block';
            }

            loadDashboard();
        }

        async function verifyToken() {
            try {
                const res = await fetch(`${API_URL}/auth/me`, { headers: { 'Authorization': `Bearer ${authToken}` } });
                if (res.ok) {
                    currentUser = await res.json();
                    document.getElementById('userInfo').textContent = `${currentUser.username} (${currentUser.role})`;
                    showAdmin();
                } else { logout(); }
            } catch (e) { logout(); }
        }

        function switchTab(tab) {
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            const activeTab = document.querySelector(`.nav-tab[onclick="switchTab('${tab}')"]`);
            if (activeTab) activeTab.classList.add('active');

            ['dashboard', 'editor', 'members', 'users', 'messages', 'blicak', 'competitions', 'gallery'].forEach(v => {
                const el = document.getElementById(v + 'View');
                if (el) el.classList.add('hidden');
            });

            const view = document.getElementById(tab + 'View');
            if (view) view.classList.remove('hidden');

            if (tab === 'dashboard') loadDashboard();
            else if (tab === 'members') loadMembers();
            else if (tab === 'users') loadUsers();
            else if (tab === 'messages') loadAdminMessages();
            else if (tab === 'blicak') loadBlicakRegistrations();
            else if (tab === 'competitions') loadCompetitions();
            else if (tab === 'gallery') loadAdminGallery();
        }

        // Dashboard
        async function loadDashboard() {
            try {
                const res = await fetch(`${API_URL}/news`, { headers: { 'Authorization': `Bearer ${authToken}` } });
                const news = await res.json();
                document.getElementById('newsTableBody').innerHTML = news.map(item => `
                    <tr>
                        <td>${new Date(item.publishedDate).toLocaleDateString('cs-CZ')}</td>
                        <td>${item.title}</td>
                        <td class="hide-mobile">${item.category}</td>
                        <td class="hide-mobile"><span class="highlight-name" style="font-size: 0.85rem;">${item.author?.username || '-'}</span></td>
                        <td class="hide-mobile"><span class="status-badge ${item.isPublished ? 'status-published' : 'status-draft'}">${item.isPublished ? '九' : '餃'}<span class="status-text">${item.isPublished ? ' Pub' : ' Konc'}</span></span></td>
                        <td>
                            <button class="action-btn btn-edit" onclick="editNews(${item.id})"><i class="fa-solid fa-pen"></i></button>
                            <button class="action-btn btn-publish" onclick="togglePublish(${item.id})" title="${item.isPublished ? 'Skr칳t' : 'Publikovat'}"><i class="fa-solid fa-${item.isPublished ? 'eye-slash' : 'eye'}"></i></button>
                            ${['admin', 'superadmin'].includes(currentUser.role) ? `<button class="action-btn btn-delete" onclick="deleteNews(${item.id})"><i class="fa-solid fa-trash"></i></button>` : ''}
                        </td>
                    </tr>
                `).join('');
            } catch (e) { console.error(e); }
        }

        async function togglePublish(id) {
            try {
                await fetch(`${API_URL}/news/${id}/publish`, { method: 'PATCH', headers: { 'Authorization': `Bearer ${authToken}` } });
                loadDashboard();
            } catch (e) { console.error(e); }
        }

        async function loadBlicakRegistrations() {
            try {
                const res = await fetch(`${API_URL}/registration/blicak`, { headers: { 'Authorization': `Bearer ${authToken}` } });
                if (res.ok) {
                    const regs = await res.json();
                    const tbody = document.getElementById('blicakTableBody');
                    const info = document.getElementById('noBlicakInfo');

                    if (regs.length === 0) {
                        tbody.innerHTML = '';
                        info.style.display = 'block';
                        return;
                    }

                    info.style.display = 'none';
                    tbody.innerHTML = regs.map(reg => `
                <tr>
                    <td><strong>${escapeHtml(reg.name)}</strong></td>
                    <td>${escapeHtml(reg.club || '-')}</td>
                    <td>${escapeHtml(reg.lok || '-')}</td>
                    <td>${escapeHtml(reg.birthYear)}</td>
                    <td>${new Date(reg.createdAt).toLocaleString('cs-CZ')}</td>
                </tr>
            `).join('');
                }
            } catch (e) { console.error(e); }
        }

        // Editor
        function resetEditor() {
            document.getElementById('editorTitle').textContent = 'Nov치 novinka';
            document.getElementById('editNewsId').value = '';
            document.getElementById('newsTitle').value = '';
            document.getElementById('articleContent').innerHTML = '';
            document.getElementById('newsExcerpt').value = '';

            // Set date to today (local time)
            const today = new Date();
            const localIso = new Date(today.getTime() - (today.getTimezoneOffset() * 60000)).toISOString().split('T')[0];
            document.getElementById('newsDate').value = localIso;

            document.getElementById('publishCheck').checked = false;
            document.getElementById('imageUrl').value = '';

            uploadedImageData = null;
            games = [];
            teams = ['A t칳m', 'B t칳m'];
            selectedTeams = ['A t칳m', 'B t칳m'];
            galleryImages = [];

            document.getElementById('uploadArea').classList.remove('has-image');
            document.getElementById('uploadPlaceholder').style.display = 'block';
            document.getElementById('uploadedImage').style.display = 'none';

            // renderTeamCheckboxes(); // Removed as function is missing/legacy
            renderGames();
            document.getElementById('galleryPreview').innerHTML = '';
            updatePreview();

            // Clear auto-saved draft
            localStorage.removeItem('newsDraft');
        }

        async function editNews(id) {
            try {
                const res = await fetch(`${API_URL}/news/${id}`);
                const item = await res.json();

                switchTab('editor');
                resetEditor(); // Clear previous state

                document.getElementById('editorTitle').textContent = 'Upravit novinku';
                document.getElementById('editNewsId').value = item.id;
                document.getElementById('newsTitle').value = item.title;
                document.getElementById('newsCategory').value = item.category;
                document.getElementById('newsDate').value = item.publishedDate.split('T')[0];
                document.getElementById('articleContent').innerHTML = item.content || '';
                document.getElementById('newsExcerpt').value = item.excerpt;
                document.getElementById('publishCheck').checked = item.isPublished;

                if (item.thumbnailUrl) {
                    // Extract crop if present
                    let url = item.thumbnailUrl;
                    let crop = '50%';
                    if (url.includes('#crop=')) {
                        const parts = url.split('#crop=');
                        url = parts[0];
                        crop = parts[1];
                    }

                    uploadedImageData = url;
                    imageCropPosition = crop;

                    // Set slider
                    const numericCrop = parseInt(crop) || 50;
                    document.getElementById('cropSlider').value = numericCrop;
                    document.getElementById('cropValueLabel').textContent = numericCrop + '%';

                    displayImage(url);
                    document.getElementById('imageUrl').value = url;
                } else {
                    // Reset defaults
                    imageCropPosition = '50%';
                    document.getElementById('cropSlider').value = 50;
                    document.getElementById('cropValueLabel').textContent = '50%';
                }

                // Load games from database
                if (item.gamesJson) {
                    try {
                        games = JSON.parse(item.gamesJson);
                        // Backwards compatibility: if simple list of games without type check, assume they are games
                        // If we see 'team' prop and no headers, we might want to respect it? 
                        // Actually, let's just render what we have. If users save, it will be new format.
                    } catch (e) { console.error(e); }
                }

                // Load gallery from database
                if (item.galleryJson) {
                    galleryImages = JSON.parse(item.galleryJson);
                } else {
                    galleryImages = [];
                }

                renderGames();
                renderGallery();
                updatePreview();
            } catch (e) {
                console.error(e);
                // Fallback rendering in case of partial failure
                renderGames();
                renderGallery();
            }
        }

        async function saveNews() {
            const id = document.getElementById('editNewsId').value;
            const method = id ? 'PUT' : 'POST';
            const url = id ? `${API_URL}/news/${id}` : `${API_URL}/news`;

            const data = {
                title: document.getElementById('newsTitle').value,
                category: document.getElementById('newsCategory').value,
                publishedDate: document.getElementById('newsDate').value,
                content: document.getElementById('articleContent').innerHTML,
                excerpt: document.getElementById('newsExcerpt').value,
                excerpt: document.getElementById('newsExcerpt').value,
                thumbnailUrl: uploadedImageData ? (uploadedImageData + '#crop=' + imageCropPosition) : null,
                isPublished: document.getElementById('publishCheck').checked,
                gamesJson: JSON.stringify(games),
                // teamsJson: null, // Legacy field, no longer used
                galleryJson: JSON.stringify(galleryImages)
            };

            // Validate required fields
            if (!data.title) {
                showAlert('Vypl켿te nadpis', 'error');
                return;
            }
            if (!data.publishedDate) {
                showAlert('Vypl켿te datum publikace', 'error');
                return;
            }
            if (!data.excerpt) {
                showAlert('Vypl켿te kr치tk칳 popis', 'error');
                return;
            }

            try {
                const res = await fetch(url, {
                    method,
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                    body: JSON.stringify(data)
                });

                if (res.ok) {
                    showAlert('Ulo쬰no!', 'success');
                    switchTab('dashboard');
                } else {
                    // Try to get error details from response
                    let errorMsg = 'Chyba p콏i ukl치d치n칤';
                    try {
                        const errorData = await res.json();
                        if (errorData.error) {
                            errorMsg = `Chyba: ${errorData.error}`;
                        } else if (errorData.message) {
                            errorMsg = `Chyba: ${errorData.message}`;
                        }
                    } catch (parseErr) {
                        const errorText = await res.text();
                        if (errorText) {
                            errorMsg = `Chyba ${res.status}: ${errorText.substring(0, 100)}`;
                        } else {
                            errorMsg = `Chyba ${res.status}: ${res.statusText}`;
                        }
                    }
                    console.error('Save error:', errorMsg);
                    showAlert(errorMsg, 'error');
                }
            } catch (e) {
                console.error('Connection error:', e);
                showAlert('Chyba spojen칤: ' + e.message, 'error');
            }
        }

        async function deleteNews(id) {
            if (!confirm('Opravdu smazat?')) return;
            try {
                await fetch(`${API_URL}/news/${id}`, { method: 'DELETE', headers: { 'Authorization': `Bearer ${authToken}` } });
                loadDashboard();
            } catch (e) { console.error(e); }
        }

        // WYSIWYG
        function formatText(command) {
            document.execCommand(command, false, null);
            document.getElementById('articleContent').focus();
            checkToolbarState();
        }

        function toggleSource() {
            const contentDiv = document.getElementById('articleContent');
            const sourceArea = document.getElementById('articleSource');
            const btn = document.getElementById('btnSource');

            if (sourceArea.classList.contains('hidden')) {
                // Switch to Source
                sourceArea.value = contentDiv.innerHTML;
                contentDiv.classList.add('hidden');
                sourceArea.classList.remove('hidden');
                btn.classList.add('active');
            } else {
                // Switch to WYSIWYG
                contentDiv.innerHTML = sourceArea.value;
                sourceArea.classList.add('hidden');
                contentDiv.classList.remove('hidden');
                btn.classList.remove('active');
                updatePreview();
            }
        }

        function updateContentFromSource() {
            const contentDiv = document.getElementById('articleContent');
            const sourceArea = document.getElementById('articleSource');
            contentDiv.innerHTML = sourceArea.value;
            updatePreview();
        }

        function insertHighlight(type) {
            const editor = document.getElementById('articleContent');
            const selection = window.getSelection();

            if (!selection.rangeCount) return;

            const range = selection.getRangeAt(0);
            const className = type === 'name' ? 'highlight-name' : 'highlight-score';
            let parentSpan = null;

            // 1. Check if we are inside a highlight span
            let el = range.commonAncestorContainer;
            if (el.nodeType === 3) el = el.parentNode;

            while (el && el !== editor) {
                if (el.classList && (el.classList.contains('highlight-name') || el.classList.contains('highlight-score'))) {
                    parentSpan = el;
                    break;
                }
                el = el.parentNode;
            }

            if (parentSpan) {
                // We are inside a span.
                // If it is the SAME type -> Exit (Toggle Off)
                if (parentSpan.classList.contains(className)) {
                    // SAME TYPE: Move cursor OUT via a neutral buffer
                    // Check if there is already a neutral node after
                    let nextNode = parentSpan.nextSibling;
                    if (nextNode && nextNode.nodeType === 1 && nextNode.tagName === 'SPAN' && !nextNode.className) {
                        // Already have a buffer span, just move into it
                        const newRange = document.createRange();
                        newRange.selectNodeContents(nextNode);
                        newRange.collapse(false); // End of span
                        selection.removeAllRanges();
                        selection.addRange(newRange);
                    } else if (nextNode && nextNode.nodeType === 3) {
                        // Text node exists, move to start of it
                        const newRange = document.createRange();
                        newRange.setStart(nextNode, 0);
                        newRange.collapse(true);
                        selection.removeAllRanges();
                        selection.addRange(newRange);
                    } else {
                        // Create neutral span buffer
                        const neutralSpan = document.createElement('span');
                        neutralSpan.innerHTML = '&nbsp;'; // Visible space

                        if (parentSpan.nextSibling) {
                            parentSpan.parentNode.insertBefore(neutralSpan, parentSpan.nextSibling);
                        } else {
                            parentSpan.parentNode.appendChild(neutralSpan);
                        }
                    }
                    editor.focus();
                } else {
                    parentSpan.className = className;
                }
            } else {
                const span = document.createElement('span');
                span.className = className;
                span.innerHTML = '\u200B' + (type === 'name' ? '[Jm칠no]' : '[Sk칩re]');
                try {
                    range.insertNode(span);
                } catch (e) { console.error(e); }
            }
            editor.focus();
            if (typeof updatePreview === 'function') updatePreview();
            if (typeof checkToolbarState === 'function') checkToolbarState();
        }


        // --- Gallery Management ---
        async function loadAdminGallery() {
            const tbody = document.getElementById('galleryTableBody');
            if (!tbody) return;

            // Helper to log status to UI
            const logStatus = (msg) => {
                tbody.innerHTML = `<tr><td colspan="5" style="text-align: center; color: #fbbf24; padding: 2rem;">${msg}</td></tr>`;
            };

            logStatus('<i class="fa-solid fa-spinner fa-spin"></i> Startuji na캜칤t치n칤...');

            if (!authToken) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: red;">Chyba: Chyb칤 p콏ihl치코en칤 token</td></tr>';
                return;
            }

            try {
                logStatus(`<i class="fa-solid fa-network-wired"></i> Vol치m API: ${API_URL}/images...`);

                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000); // 10s timeout

                const res = await fetch(`${API_URL}/images`, {
                    headers: { 'Authorization': `Bearer ${authToken}` },
                    signal: controller.signal
                });
                clearTimeout(timeoutId);

                logStatus(`<i class="fa-solid fa-server"></i> Odpov캩캞 serveru: ${res.status}`);

                if (!res.ok) {
                    const text = await res.text();
                    let errMsg = `Chyba ${res.status}`;
                    try { const j = JSON.parse(text); if (j.error) errMsg += `: ${j.error}`; } catch (e) { errMsg += `: ${text.substring(0, 50)}`; }
                    throw new Error(errMsg);
                }

                logStatus('<i class="fa-solid fa-code"></i> Zpracov치v치m data...');
                const images = await res.json();

                if (images.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 2rem;">콯치dn칠 obr치zky v galerii.</td></tr>';
                    return;
                }

                // Render images
                tbody.innerHTML = images.map(img => `
                    <tr>
                        <td>
                            <img src="${img.url}" style="width: 60px; height: 40px; object-fit: cover; border-radius: 4px; cursor: pointer;" onclick="window.open('${img.url}', '_blank')">
                        </td>
                        <td>${img.originalName || '-'}</td>
                        <td style="text-align: center;">
                             <input type="checkbox" ${img.isPublic ? 'checked' : ''} onchange="toggleGalleryVisibility(${img.id}, this.checked)" style="transform: scale(1.5); cursor: pointer;">
                        </td>
                        <td>${new Date(img.uploadedAt).toLocaleString('cs-CZ')}</td>
                        <td>
                            <button class="action-btn btn-delete" onclick="deleteGalleryImage(${img.id})" title="Smazat">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
                console.log('Gallery rendered');

            } catch (e) {
                console.error('Gallery Error:', e);
                tbody.innerHTML = `<tr><td colspan="5" style="text-align: center; color: red; padding: 2rem;">
                    <i class="fa-solid fa-triangle-exclamation"></i> Chyba: ${e.name === 'AbortError' ? 'Timeout (server neodpov칤d치)' : e.message}
                </td></tr>`;
            }
        }

        async function toggleGalleryVisibility(id, checked) {
            try {
                const res = await fetch(`${API_URL}/images/${id}/toggle`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ isPublic: checked })
                });
                if (res.ok) showToast('Viditelnost zm캩n캩na');
                else showToast('Chyba zm캩ny', 'error');
            } catch (e) {
                showToast('Chyba spojen칤', 'error');
            }
        }

        async function deleteGalleryImage(id) {
            if (!confirm('Smazat?')) return;
            try {
                const res = await fetch(`${API_URL}/images/${id}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                if (res.ok) {
                    showToast('Smaz치no');
                    loadAdminGallery();
                } else {
                    showToast('Chyba', 'error');
                }
            } catch (e) {
                showToast('Chyba', 'error');
            }
        }

        // Minimal Placeholders for missing functions to avoid crashes
        function checkToolbarState() { }
        function updatePreview() { }
        async function loadDashboard() { }
        async function loadMembers() { }
        async function loadUsers() { }
        async function loadAdminMessages() { }
        async function loadBlicakRegistrations() { }
        async function loadCompetitions() { }


        async function handleAdminGalleryUpload(input) {
            if (!input.files || input.files.length === 0) return;

            const files = Array.from(input.files);
            let successCount = 0;

            // Upload sequentially
            for (const file of files) {
                const formData = new FormData();
                formData.append('image', file);

                try {
                    const res = await fetch(`${API_URL}/images/upload`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${authToken}`
                        },
                        body: formData
                    });

                    if (res.ok) successCount++;
                } catch (e) {
                    console.error('Upload failed for file:', file.name, e);
                }
            }

            if (successCount > 0) {
                showToast(`Nahr치no ${successCount} obr치zk콢`);
                loadAdminGallery();
            } else {
                showToast('Nahr치v치n칤 selhalo', 'error');
            }

            input.value = ''; // Reset input
        }


        async function triggerMigration() {
            const btn = event.target.closest('button');
            if (btn) {
                btn.disabled = true;
                btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Pracuji...';
            }

            try {
                const res = await fetch(`${API_URL}/admin/migrate`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });

                let data = {};
                try { data = await res.json(); } catch (e) { }

                console.log('Migrace:', data);

                if (btn) {
                    btn.innerHTML = '<i class="fa-solid fa-check"></i> Hotovo';
                    btn.classList.remove('btn-warning');
                    btn.classList.add('btn-success');
                }

                // Reload gallery after 2s
                setTimeout(() => {
                    loadAdminGallery();
                    if (btn) {
                        btn.disabled = false;
                        btn.innerHTML = '<i class="fa-solid fa-wrench"></i> Opravit DB';
                        btn.classList.remove('btn-success');
                        btn.classList.add('btn-warning');
                    }
                }, 2000);
            } catch (e) {
                if (btn) {
                    btn.innerHTML = '<i class="fa-solid fa-triangle-exclamation"></i> Chyba';
                    btn.disabled = false;
                }
                alert('Chyba: ' + e.message);
            }
        }
    </script>
</body>

</html>