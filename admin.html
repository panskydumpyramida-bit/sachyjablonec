<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Správa webu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css?v=ux12">
    <link rel="stylesheet" href="css/admin.css?v=ux12">
    <script src="js/version.js?v=ux12"></script>
    <script src="js/modal-manager.js?v=ux12"></script>
</head>

<body>
    <!-- LOGIN -->
    <div id="loginPage" class="hidden">
        <div class="login-container">
            <h1 style="text-align: center; margin-bottom: 2rem;"><i class="fa-solid fa-chess-knight"
                    style="color: var(--primary-color);"></i><br>Admin Panel v2025.12.14</h1>
            <div id="loginError"></div>
            <form id="loginForm">
                <div class="form-group"><label>Uživatelské jméno</label><input type="text" id="username" required>
                </div>
                <div class="form-group"><label>Heslo</label>
                    <div style="position: relative;"><input type="password" id="password" required
                            style="padding-right: 40px;"><i class="fa-solid fa-eye" id="togglePassword"
                            style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; color: var(--text-muted);"></i>
                    </div>
                </div><button type="submit" class="btn-primary" style="width: 100%">Přihlásit se</button>
            </form>
        </div>
    </div>
    <!-- ADMIN PANEL -->
    <div id="adminPanel" class="hidden">
        <header>
            <div class="container">
                <nav><a href="/" class="logo"><i class="fa-solid fa-chess-knight"></i>TJ Bižuterie -
                        Admin</a>
                    <ul class="nav-links">
                        <li><a href="/" target="_blank"><i class="fa-solid fa-home"></i>Web</a></li>
                        <li><a href="#" onclick="logout()" style="color: #fca5a5;"><i
                                    class="fa-solid fa-sign-out-alt"></i>Odhlásit</a></li>
                    </ul>
                </nav>
            </div>
        </header>
        <div class="admin-container">
            <div class="admin-header">
                <div>
                    <h1><i class="fa-solid fa-cogs"></i>Správa webu</h1>
                    <p style="margin: 0.25rem 0 0 0; font-size: 0.9rem; opacity: 0.8; visibility: visible !important;"
                        id="userInfo"></p>
                    <p style="margin: 0.1rem 0 0 0; font-size: 0.7rem; opacity: 0.5; font-family: monospace;">
                        Build:
                        <script>document.write(new Date().toISOString().slice(0, 10) + ' #v' + APP_VERSION)</script>
                    </p>
                </div>
            </div>
            <div class="admin-nav">
                <div class="nav-tab active" onclick="switchTab('dashboard')"><i class="fa-solid fa-list"></i>Přehled
                </div>

                <div class="nav-tab" onclick="switchTab('members')" style="display: none;"><i
                        class="fa-solid fa-address-book"></i>Členové </div>
                <div class="nav-tab" onclick="switchTab('users')" id="usersTab" style="display: none;"><i
                        class="fa-solid fa-users"></i>Uživatelé <i class="fa-solid fa-lock"
                        style="font-size: 0.7em; margin-left: 0.4rem; color: #fbbf24; opacity: 0.8;"
                        title="Superadmin only"></i></div>
                <div class="nav-tab" onclick="switchTab('competitions')" id="competitionsTab" style="display: none;"><i
                        class="fa-solid fa-trophy"></i>Soutěže</div>
                <div class="nav-tab" onclick="switchTab('gallery')" id="galleryTab" style="display: none;"><i
                        class="fa-regular fa-images"></i>Galerie</div>
                <div class="nav-tab" onclick="switchTab('events')" id="eventsTab"><i
                        class="fa-regular fa-calendar-days"></i>Události
                </div>
                <div class="nav-divider"></div>
                <div class="nav-tab secondary" onclick="switchTab('games')" id="gamesTab"><i
                        class="fa-solid fa-chess-board"></i>Partie</div>
                <div class="nav-tab secondary" onclick="switchTab('blicak')" id="blicakTab"><i
                        class="fa-solid fa-bolt"></i>Blicák
                </div>
                <div class="nav-tab secondary" id="puzzleRacerTab" onclick="switchTab('puzzleRacer')"><i
                        class="fa-solid fa-puzzle-piece"></i>Puzzle Racer <i class="fa-solid fa-lock"
                        style="font-size: 0.7em; margin-left: 0.4rem; color: #fbbf24; opacity: 0.8;"
                        title="Superadmin only"></i></div>
                <div class="nav-tab secondary" onclick="switchTab('chessdb')" id="chessdbTab"><i
                        class="fa-solid fa-database"></i>Databáze</div>
                <div class="nav-tab secondary" onclick="switchTab('changelog')" id="changelogTab"><i
                        class="fa-solid fa-code-branch"></i>Changelog</div>
            </div>
            <div id="alertContainer"></div>
            <!-- DASHBOARD -->
            <div id="dashboardView">
                <!-- Dashboard Grid -->
                <div class="dashboard-grid">
                    <!-- Stats Cards -->
                    <div id="dashboardStats" class="dashboard-stats">
                        <!-- Skeleton loaders -->
                        <div class="stat-card" style="--accent-color: #d4af37">
                            <div class="stat-card-icon"><i class="fa-solid fa-spinner fa-spin"></i></div>
                            <div class="stat-card-content">
                                <div class="stat-card-value">—</div>
                                <div class="stat-card-label">Načítám...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Two Column: Quick Actions + Activity -->
                    <div class="dashboard-columns">
                        <!-- Quick Actions Panel -->
                        <div class="quick-actions">
                            <div class="quick-actions-title">
                                <i class="fa-solid fa-bolt"></i> Rychlé akce
                            </div>
                            <div class="quick-actions-grid">
                                <button class="quick-action-btn" onclick="dashboardQuickAction('new-article')">
                                    <i class="fa-solid fa-plus"></i>
                                    <span>Nový článek</span>
                                </button>
                                <button class="quick-action-btn" onclick="dashboardQuickAction('new-game')">
                                    <i class="fa-solid fa-chess"></i>
                                    <span>Přidat partii</span>
                                </button>
                                <button class="quick-action-btn" onclick="dashboardQuickAction('new-event')">
                                    <i class="fa-regular fa-calendar-plus"></i>
                                    <span>Nová událost</span>
                                </button>
                                <button class="quick-action-btn" onclick="dashboardQuickAction('gallery')">
                                    <i class="fa-regular fa-images"></i>
                                    <span>Galerie</span>
                                </button>
                                <button class="quick-action-btn" onclick="dashboardQuickAction('refresh-standings')">
                                    <i class="fa-solid fa-sync"></i>
                                    <span>Aktualizovat tabulky</span>
                                </button>
                                <button class="quick-action-btn" onclick="window.open('/', '_blank')">
                                    <i class="fa-solid fa-eye"></i>
                                    <span>Zobrazit web</span>
                                </button>
                            </div>
                        </div>

                        <!-- Activity Feed Panel -->
                        <div class="activity-panel">
                            <div class="activity-title">
                                <i class="fa-solid fa-clock-rotate-left"></i> Nedávná aktivita
                            </div>
                            <div id="dashboardActivity">
                                <div class="activity-empty">
                                    <i class="fa-solid fa-spinner fa-spin"></i>
                                    <span>Načítám aktivitu...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- News List Section -->
                <div class="dashboard-divider">
                    <span>Články</span>
                </div>

                <h2 style="margin: 0 0 1rem 0;">Seznam novinek</h2>
                <table class="data-table" id="newsTable">
                    <thead>
                        <tr>
                            <th>Datum</th>
                            <th>Název</th>
                            <th class="hide-mobile">Kategorie</th>
                            <th class="hide-mobile">Autor</th>
                            <th class="hide-mobile">Stav</th>
                            <th>Akce</th>
                        </tr>
                    </thead>
                    <tbody id="newsTableBody"></tbody>
                </table>
            </div>
            <!-- EDITOR -->
            <div id="editorView" class="hidden">
                <div class="editor-layout">
                    <!-- Main Editor (70%) -->
                    <div class="editor-main">
                        <h2 style="margin-top: 0;" id="editorTitle">Nová novinka</h2><input type="hidden"
                            id="editNewsId">
                        <div class="form-group"><label>Nadpis článku *</label>
                            <textarea id="newsTitle" rows="1" class="auto-resize" placeholder="Zadejte nadpis..."
                                oninput="updatePreview();"></textarea>
                        </div>
                        <!-- WYSIWYG Editor -->
                        <div class="form-group"><label>Obsah článku *</label>
                            <div class="wysiwyg-toolbar" style="flex-wrap: wrap;">
                                <!-- History -->
                                <button type="button" onmousedown="event.preventDefault()" onclick="formatText('undo')"
                                    title="Zpět (Ctrl+Z)"><i class="fa-solid fa-rotate-left"></i></button>
                                <button type="button" onmousedown="event.preventDefault()" onclick="formatText('redo')"
                                    title="Vpřed (Ctrl+Y)"><i class="fa-solid fa-rotate-right"></i></button>
                                <div class="divider"></div>
                                <!-- Row 1: Formatting --><button type="button" id="btnBold"
                                    onclick="formatText('bold')" title="Tučně (Ctrl+B)"><i
                                        class="fa-solid fa-bold"></i></button><button type="button" id="btnItalic"
                                    onclick="formatText('italic')" title="Kurzíva (Ctrl+I)"><i
                                        class="fa-solid fa-italic"></i></button><button type="button" id="btnUnderline"
                                    onclick="formatText('underline')" title="Podtržení (Ctrl+U)"><i
                                        class="fa-solid fa-underline"></i></button><button type="button"
                                    onclick="removeFormatting()" title="Odstranit formátování"
                                    style="color: #94a3b8;"><i class="fa-solid fa-eraser"></i></button>
                                <div class="divider"></div>
                                <!-- Heading buttons -->
                                <div
                                    style="display: flex; gap: 2px; background: rgba(255,255,255,0.05); border-radius: 4px; padding: 2px;">
                                    <button type="button" id="headingP" onclick="applyHeading('p')"
                                        title="Normální text"
                                        style="padding: 0.25rem 0.5rem; font-size: 0.7rem; font-weight: 600; border-radius: 3px; min-width: 28px;">P</button><button
                                        type="button" id="headingH1" onclick="applyHeading('h1')" title="Nadpis 1"
                                        style="padding: 0.25rem 0.5rem; font-size: 0.7rem; font-weight: 700; border-radius: 3px; min-width: 28px;">H1</button><button
                                        type="button" id="headingH2" onclick="applyHeading('h2')" title="Nadpis 2"
                                        style="padding: 0.25rem 0.5rem; font-size: 0.7rem; font-weight: 600; border-radius: 3px; min-width: 28px;">H2</button><button
                                        type="button" id="headingH3" onclick="applyHeading('h3')" title="Nadpis 3"
                                        style="padding: 0.25rem 0.5rem; font-size: 0.7rem; font-weight: 500; border-radius: 3px; min-width: 28px;">H3</button>
                                </div>
                                <div class="divider"></div><button type="button" onclick="insertLink()" title="Odkaz"><i
                                        class="fa-solid fa-link"></i></button><button type="button"
                                    onclick="toggleSource()" title="HTML" id="btnSource"><i
                                        class="fa-solid fa-code"></i></button>
                                <!-- Row 2: Highlights and blocks (will wrap on smaller
                                                            screens) -->
                                <div class="divider" style="height: 0; width: 100%; margin: 0.25rem 0;">
                                </div><button type="button" id="btnHighlightName" onmousedown="event.preventDefault()"
                                    onclick="insertHighlight('name')" title="Zvýraznit jméno" style="color: #60a5fa;"><i
                                        class="fa-solid fa-user"></i>Jméno</button><button type="button"
                                    id="btnHighlightScore" onmousedown="event.preventDefault()"
                                    onclick="insertHighlight('score')" title="Zvýraznit skóre"
                                    style="color: #4ade80;"><i class="fa-solid fa-trophy"></i>Skóre</button><button
                                    type="button" onclick="autoFormatEntireContent()"
                                    title="Auto-formátování celého textu (najde výsledky a jména)"
                                    style="color: #a78bfa;"><i class="fa-solid fa-wand-magic-sparkles"></i>Auto</button>
                                <div class="divider"></div><button type="button" onclick="insertIntroBlock()"
                                    title="Infobox" style="color: #fbbf24;"><i
                                        class="fa-solid fa-lightbulb"></i></button><button type="button"
                                    onclick="insertImage()" title="Obrázek" style="color: #f472b6;"><i
                                        class="fa-solid fa-image"></i></button><button type="button"
                                    onclick="insertDiagram()" title="Vložit diagram" style="color: #d4a373;"><i
                                        class="fa-solid fa-chess-board"></i></button><button type="button"
                                    onclick="insertCollapsibleBlock()" title="Rozbalovací sekce"
                                    style="color: #8b5cf6;"><i class="fa-solid fa-layer-group"></i></button>
                                <!-- AI Tools -->
                                <div class="divider"></div>
                                <button type="button" onclick="aiSpellCheck()"
                                    title="AI Oprava pravopisu (Ctrl+Shift+S)" style="color: #10b981;"><i
                                        class="fa-solid fa-spell-check"></i>AI</button>
                                <!-- Table Tools -->
                                <div class="divider"></div>
                                title="AI Převod na tabulku (vyberte text)" style="color: #06b6d4;"><i
                                    class="fa-solid fa-table"></i></button>
                                <div class="divider"></div>
                                <button type="button" onclick="showShortcutsModal()"
                                    title="Klávesové zkratky a nápověda (?)"><i
                                        class="fa-regular fa-keyboard"></i></button>
                            </div>
                            <div class="wysiwyg-content" id="articleContent" contenteditable="true"
                                oninput="updatePreview()"></div><textarea id="articleSource"
                                class="wysiwyg-content hidden" oninput="updateContentFromSource()"></textarea>
                        </div>
                        <!-- Games Panel -->
                        <div class="panel-section">
                            <div class="panel-header"><label style="margin: 0;"><i
                                        class="fa-solid fa-chess-board"></i>Přehrávač
                                    partií</label></div>
                            <div class="form-group" id="gamesInputPanel">
                                <div
                                    style="display: flex; gap: 0.75rem; flex-wrap: wrap; align-items: center; background: rgba(255,255,255,0.03); padding: 0.75rem 1rem; border-radius: 8px; margin-bottom: 0.75rem;">
                                    <!-- PGN -->
                                    <div style="display: flex; gap: 0.4rem; align-items: center;">
                                        <span style="font-size: 0.8rem; color: #60a5fa; font-weight: 600;"><i
                                                class="fa-solid fa-chess"></i></span>
                                        <button type="button" class="btn-primary btn-small"
                                            onclick="showRecordedGamesModal()"
                                            style="padding: 0.4rem 0.7rem; font-size: 0.8rem; background: #3b82f6;">
                                            <i class="fa-solid fa-database"></i> Z DB
                                        </button>
                                        <button type="button" class="btn-primary btn-small"
                                            onclick="showNewsGamePgnModal()"
                                            style="padding: 0.4rem 0.7rem; font-size: 0.8rem; background: #10b981;">
                                            <i class="fa-solid fa-paste"></i> PGN
                                        </button>
                                    </div>

                                    <div style="height: 24px; width: 1px; background: rgba(255,255,255,0.15);"></div>

                                    <!-- Chess.com -->
                                    <div style="display: flex; gap: 0.4rem; align-items: center;">
                                        <span
                                            style="font-size: 0.8rem; color: #81b64c; font-weight: 600; display: flex; align-items: center; gap: 4px;">
                                            <i class="fa-solid fa-globe"></i> Chess.com:
                                        </span>
                                        <input type="text" id="gameTitle" placeholder="Bílý - Černý"
                                            style="width: 120px; font-size: 0.8rem; padding: 0.4rem;">
                                        <input type="text" id="gameId" placeholder="Pouze ID partie"
                                            title="Vložte ID partie z URL (např. 123456789)"
                                            style="width: 100px; font-size: 0.8rem; padding: 0.4rem;">
                                        <label
                                            style="display: flex; align-items: center; gap: 0.25rem; cursor: pointer; font-size: 0.75rem; color: var(--text-muted);">
                                            <input type="checkbox" id="gameCommented"
                                                style="width: auto; margin: 0;">Kom.
                                        </label>
                                        <button type="button" class="btn-primary btn-small" onclick="addGame()"
                                            style="padding: 0.4rem 0.6rem; font-size: 0.8rem; background: #81b64c;">
                                            <i class="fa-solid fa-plus"></i> Přidat
                                        </button>
                                    </div>

                                    <div style="height: 24px; width: 1px; background: rgba(255,255,255,0.15);"></div>

                                    <!-- Separator / Header -->
                                    <button type="button" class="btn-secondary btn-small" onclick="showHeaderModal()"
                                        style="padding: 0.4rem 0.7rem; font-size: 0.8rem; color: var(--primary-color);">
                                        <i class="fa-solid fa-heading"></i> Oddělovač
                                    </button>
                                </div>
                            </div>
                            <div id="gamesList" style="margin-top: 1rem;"></div>
                        </div>
                        <!-- Gallery Panel -->
                        <div class="panel-section">
                            <div class="panel-header"><label style="margin: 0;"><i
                                        class="fa-solid fa-images"></i>Galerie</label>
                                <div style="display: flex; gap: 0.5rem;"><button type="button"
                                        class="btn-secondary btn-small"
                                        onclick="document.getElementById('galleryInput').click()"><i
                                            class="fa-solid fa-upload"></i>Nahrát</button><button type="button"
                                        class="btn-secondary btn-small" onclick="toggleGalleryUrlInput()"><i
                                            class="fa-solid fa-link"></i>URL</button><button type="button"
                                        class="btn-secondary btn-small" onclick="selectGalleryForArticleGallery()"
                                        title="Vybrat z existující galerie"><i
                                            class="fa-regular fa-images"></i></button>
                                </div><input type="file" id="galleryInput" accept="image/*" multiple
                                    style="display: none;" onchange="addGalleryImages(event)">
                            </div>
                            <div id="galleryUrlInput" class="hidden" style="margin-bottom: 0.75rem;">
                                <div style="display: flex; gap: 0.5rem;"><input type="text" id="galleryImageUrl"
                                        placeholder="URL obrázku (https://...)"
                                        style="flex: 1; font-size: 0.85rem;"><button type="button"
                                        class="btn-primary btn-small" onclick="addGalleryFromUrl()">Přidat</button>
                                </div>
                            </div>
                            <div id="galleryPreview" style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                            </div>
                        </div>
                        <div style="margin-top: 2rem; display: flex; gap: 1rem;"><button class="btn-primary"
                                onclick="saveNews()"><i class="fa-solid fa-save"></i>Uložit</button><button
                                class="btn-secondary" onclick="switchTab('dashboard')">Zrušit</button></div>
                    </div>
                    <!-- Sidebar (30%) -->
                    <div class="editor-sidebar">
                        <!-- SECTION 1: Publikace (collapsible) -->
                        <div id="publikaceSection"
                            style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <div onclick="toggleSidebarSection('publikace')"
                                style="display: flex; align-items: center; justify-content: space-between; gap: 0.5rem; margin-bottom: 0.75rem; color: var(--primary-color); cursor: pointer;">
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <i class="fa-solid fa-paper-plane"></i><span
                                        style="font-weight: 600;">Publikace</span>
                                </div><i class="fa-solid fa-chevron-down" id="publikaceIcon"
                                    style="font-size: 0.7rem; transition: transform 0.2s;"></i>
                            </div>
                            <div id="publikaceContent">
                                <div class="form-group" style="margin-bottom: 0.75rem;">
                                    <label style="font-size: 0.8rem;">Kategorie</label><select id="newsCategory"
                                        onchange="updatePreview()" style="font-size: 0.85rem;">
                                        <option value="Soutěže družstev">Soutěže družstev
                                        </option>
                                        <option value="Oddílový přebor">Oddílový přebor
                                        </option>
                                        <option value="Mládež">Mládež</option>
                                        <option value="O nás">O nás</option>
                                    </select>
                                </div>
                                <!-- Author Selection -->
                                <div class="form-group" style="margin-bottom: 0.75rem;">
                                    <div
                                        style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.3rem;">
                                        <label style="font-size: 0.8rem; margin: 0;">Autor</label>
                                        <button type="button" id="toggleCoAuthorBtn" onclick="toggleCoAuthorSection()"
                                            title="Přidat spoluautora"
                                            style="width: 22px; height: 22px; padding: 0; font-size: 0.75rem; border-radius: 4px; background: rgba(212,175,55,0.2); border: 1px solid rgba(212,175,55,0.3); color: #d4af37; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                                            <i class="fa-solid fa-plus" id="toggleCoAuthorIcon"></i>
                                        </button>
                                    </div>
                                    <select id="newsAuthorId" style="font-size: 0.85rem; margin-bottom: 0.3rem;"
                                        onchange="handleAuthorChange()">
                                        <option value="">Vlastní jméno</option>
                                        <!-- Populated via JS -->
                                    </select>
                                    <input type="text" id="newsAuthorName" placeholder="Jméno autora"
                                        oninput="updatePreview()" style="font-size: 0.85rem;">
                                </div>
                                <!-- Co-Author Section (hidden by default) -->
                                <div class="form-group" id="coAuthorSection"
                                    style="margin-bottom: 0.75rem; display: none;">
                                    <label style="font-size: 0.8rem;">Spoluautor</label>
                                    <select id="newsCoAuthorId" style="font-size: 0.85rem; margin-bottom: 0.3rem;"
                                        onchange="handleCoAuthorChange()">
                                        <option value="">Žádný / Vlastní</option>
                                        <!-- Populated via JS -->
                                    </select>
                                    <input type="text" id="newsCoAuthorName" placeholder="Jméno spoluautora"
                                        oninput="updatePreview()" style="font-size: 0.85rem; display: none;">
                                </div>
                                <div class="form-group" style="margin-bottom: 0.75rem;">
                                    <label style="font-size: 0.8rem;">Datum</label><input type="date" id="newsDate"
                                        oninput="updatePreview(); updatePublishLabel();" style="font-size: 0.85rem;">
                                </div>
                                <div class="form-group" style="margin-bottom: 0.75rem;">
                                    <label style="font-size: 0.8rem;">Krátký
                                        popis</label><textarea id="newsExcerpt" rows="2" class="auto-resize"
                                        placeholder="Zobrazí se na kartě..." oninput="updatePreview()"
                                        style="font-size: 0.85rem;"></textarea>
                                </div><label
                                    style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-size: 0.85rem;"><input
                                        type="checkbox" id="publishCheck" style="width: auto;"
                                        onchange="updatePublishLabel()"><span id="publishCheckLabel">Publikovat
                                        ihned</span></label><button type="button" class="btn-primary" id="saveNewsBtn"
                                    onclick="saveNews()"
                                    style="width: 100%; margin-top: 1rem; justify-content: center;"><i
                                        class="fa-solid fa-save" id="saveNewsBtnIcon"></i><span
                                        id="saveNewsBtnText">Uložit</span></button>
                            </div>
                            <!-- end publikaceContent -->
                        </div>
                        <!-- end publikaceSection -->
                        <!-- SECTION 2: Obrázek -->
                        <div
                            style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <div
                                style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: #f472b6;">
                                <i class="fa-solid fa-image"></i><span style="font-weight: 600;">Náhledový
                                    obrázek</span>
                            </div>
                            <div class="image-upload" id="uploadArea"
                                onclick="document.getElementById('imageInput').click()"
                                style="height: 120px; margin-bottom: 0.5rem; position: relative;">
                                <div id="uploadPlaceholder"><i class="fa-solid fa-cloud-upload-alt"
                                        style="font-size: 1.2rem; color: var(--primary-color);"></i>
                                    <p style="margin: 0.3rem 0 0 0; font-size: 0.75rem;">
                                        Klikněte pro nahrání </p>
                                </div><img id="uploadedImage" class="uploaded-thumb" style="display: none;"><button
                                    type="button" id="removeImageBtn" onclick="event.stopPropagation(); removeImage();"
                                    style="display: none; position: absolute; top: 5px; right: 5px; background: rgba(0,0,0,0.7); border: none; color: #f87171; padding: 0.3rem 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.7rem;"><i
                                        class="fa-solid fa-times"></i></button>
                            </div><input type="file" id="imageInput" accept="image/*" style="display: none;"
                                onchange="handleImageUpload(event)">
                            <div id="imageUrlWrapper" style="display: flex; gap: 0.5rem; align-items: center;">
                                <input type="text" id="imageUrl" placeholder="nebo URL obrázku"
                                    style="font-size: 0.8rem; flex: 1;"><button type="button"
                                    class="btn-secondary btn-small" onclick="handleImageUrl()"
                                    style="padding: 0.4rem 0.6rem; font-size: 0.75rem;">Použít</button><button
                                    type="button" class="btn-secondary btn-small" onclick="selectGalleryForThumbnail()"
                                    style="padding: 0.4rem 0.6rem; font-size: 0.75rem;" title="Vybrat z galerie"><i
                                        class="fa-regular fa-images"></i></button>
                            </div>
                            <!-- Crop position selector -->
                            <div id="cropPositionWrapper" style="display: none; margin-top: 0.8rem;">
                                <label
                                    style="font-size: 0.75rem; color: var(--text-muted); display: flex; justify-content: space-between; margin-bottom: 0.4rem;"><span>Pozice
                                        ořezu (výška):</span><span id="cropValueLabel"
                                        style="color: var(--primary-color);">50%</span></label>
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 0.7rem; color: var(--text-muted);">Horní</span><input
                                        type="range" id="cropSlider" min="0" max="100" value="50" step="1"
                                        oninput="updateCropFromSlider(this.value)"
                                        style="flex: 1; cursor: pointer;"><span
                                        style="font-size: 0.7rem; color: var(--text-muted);">Dolní</span>
                                </div>
                            </div><button type="button" onclick="rotateImage()"
                                style="width: 100%; margin-top: 0.5rem; padding: 0.3rem; background: rgba(255, 255, 255, 0.05); border: 1px solid var(--editor-border); color: var(--text-color); border-radius: 4px; cursor: pointer; font-size: 0.75rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"><i
                                    class="fa-solid fa-rotate-right"></i>Otočit
                                o 90° </button>
                        </div>
                        <!-- SECTION 3: Náhledy -->
                        <div>
                            <div
                                style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: #60a5fa;">
                                <i class="fa-solid fa-eye"></i><span style="font-weight: 600;">Náhledy</span>
                            </div>
                            <!-- Card preview -->
                            <div class="preview-card" style="margin-bottom: 0.75rem;">
                                <div class="preview-title" style="font-size: 0.75rem; padding: 0.5rem;">
                                    Karta</div>
                                <div class="news-preview"
                                    style="width: 100%; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; overflow: hidden; background: #1a1a1a;">
                                    <div class="preview-image" id="previewImage"
                                        style="height: 120px; text-align: center; background: #000; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                                        <i class="fa-solid fa-image"
                                            style="font-size: 1.5rem; color: var(--text-muted);"></i>
                                    </div>
                                    <div class="card-content" style="padding: 0.75rem;"><span class="card-category"
                                            id="previewCategory" style="font-size: 0.6rem;">Kategorie</span><span
                                            class="card-date" id="previewDate" style="font-size: 0.55rem;">Datum</span>
                                        <h3 class="card-title" id="previewTitle"
                                            style="font-size: 0.8rem; margin: 0.3rem 0;">
                                            Nadpis</h3>
                                        <p class="card-excerpt" id="previewExcerpt"
                                            style="font-size: 0.7rem; color: var(--text-muted);">
                                            Popis...</p>

                                        <!-- Author & Stats -->
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 0.4rem;">
                                            <div
                                                style="font-size: 0.55rem; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 60%;">
                                                <i class="fa-solid fa-user-pen" style="margin-right: 2px;"></i> <span
                                                    id="previewAuthor">Autor</span>
                                            </div>
                                            <div style="font-size: 0.55rem; color: var(--text-muted);">
                                                <i class="fa-solid fa-eye" style="margin-right: 2px;"></i> <span
                                                    id="previewViews">0</span>
                                                <span style="margin-left: 5px;" title="Počet slov"><i
                                                        class="fa-solid fa-paragraph" style="margin-right: 2px;"></i>
                                                    <span id="previewWords">0</span></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- USERS -->
    <!-- MEMBERS -->
    <div id="membersView" class="hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h2 style="margin: 0;">Seznam členů</h2><button class="btn-primary" onclick="openMemberModal()"><i
                    class="fa-solid fa-user-plus"></i>Nový člen</button>
        </div>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Jméno</th>
                    <th>ELO</th>
                    <th>Titul</th>
                    <th>Narození</th>
                    <th>Role</th>
                    <th>Akce</th>
                </tr>
            </thead>
            <tbody id="membersTableBody"></tbody>
        </table>
    </div>
    <div id="usersView" class="hidden">
        <div class="editor-layout">
            <div>
                <h2>Seznam uživatelů</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Akce</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody"></tbody>
                </table>
            </div>
            <div class="editor-sidebar">
                <h3>Přidat uživatele</h3>
                <div class="form-group"><label>Username</label><input type="text" id="newUsername">
                </div>
                <div class="form-group"><label>Email</label><input type="email" id="newEmail"></div>
                <div class="form-group"><label>Heslo</label><input type="password" id="newPassword">
                </div>
                <div class="form-group"><label>Role</label><select id="newRole">
                        <option value="admin">Admin</option>
                        <option value="superadmin">Superadmin</option>
                    </select></div><button class="btn-primary" onclick="createUser()">Vytvořit</button>
            </div>
        </div>
    </div>
    <div id="messagesView" class="hidden">
        <h2><i class="fa-solid fa-comments"></i>Správa vzkazovníku</h2>
        <p style="color: var(--text-muted); margin-bottom: 1.5rem;">Zde můžete mazat nevhodné příspěvky
            ze vzkazovníku.</p>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Autor</th>
                    <th>Obsah</th>
                    <th>Datum</th>
                    <th>Akce</th>
                </tr>
            </thead>
            <tbody id="messagesTableBody"></tbody>
        </table>
        <div id="noMessagesInfo" style="text-align: center; padding: 2rem; color: var(--text-muted); display: none;">
            Žádné
            vzkazy k zobrazení. </div>
    </div>
    <!-- Games Management View -->
    <div id="gamesView" class="hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h2 style="margin: 0;"><i class="fa-solid fa-chess-board"></i>Nahrané partie</h2>
            <div style="display: flex; gap: 0.5rem;">
                <a href="/game-recorder" target="_blank" class="btn-primary"><i class="fa-solid fa-plus"></i>Nová
                    partie</a>
                <button class="btn-secondary" onclick="loadRecordedGames()"><i
                        class="fa-solid fa-sync"></i>Obnovit</button>
            </div>
        </div>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Datum</th>
                    <th>Bílý</th>
                    <th>Černý</th>
                    <th>Výsledek</th>
                    <th>Událost</th>
                    <th>Akce</th>
                </tr>
            </thead>
            <tbody id="gamesTableBody"></tbody>
        </table>
        <div id="noGamesInfo" style="text-align: center; padding: 2rem; color: var(--text-muted); display: none;">
            Žádné nahrané partie. <a href="/game-recorder" style="color: var(--primary-color);">Přidejte novou
                partii</a>
        </div>

        <!-- Analysis Settings -->
        <div class="card" style="margin-top: 2rem; border-left: 4px solid #60a5fa;">
            <h3 style="margin-top: 0; color: #60a5fa;"><i class="fa-solid fa-microchip"></i> Nastavení analýzy</h3>
            <p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 1rem;">
                Konfigurace enginu pro analýzu partií. Vyšší hloubka = přesnější analýza, ale pomalejší a vyšší spotřeba
                API limitu.
            </p>
            <div class="form-group" style="margin-bottom: 1rem;">
                <label style="display: flex; justify-content: space-between; align-items: center;">
                    <span>Hloubka analýzy (Chess-API fallback)</span>
                    <span id="chessApiDepthValue" style="color: var(--primary-color); font-weight: 600;">16</span>
                </label>
                <input type="range" id="chessApiDepthSlider" min="10" max="20" value="16" step="1"
                    oninput="updateChessApiDepth(this.value)" style="width: 100%; cursor: pointer; margin-top: 0.5rem;">
                <div
                    style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                    <span>10 (rychlé)</span>
                    <span>20 (přesné)</span>
                </div>
            </div>
            <p style="font-size: 0.75rem; color: var(--text-muted); margin: 0;">
                <i class="fa-solid fa-info-circle"></i> Primární zdroj: Lichess cloud cache (~7M pozic). Fallback:
                chess-api.com s touto hloubkou.
            </p>
        </div>

        <!-- Diagrams/Puzzles Management -->
        <div style="margin-top: 3rem; border-top: 1px solid var(--editor-border); padding-top: 2rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h2 style="margin: 0;"><i class="fa-solid fa-chess-pawn"></i> Diagramy a hádanky</h2>
                <div style="display: flex; gap: 0.5rem;">
                    <a href="/game-recorder.html" target="_blank" class="btn-primary"><i class="fa-solid fa-plus"></i>
                        Nový diagram</a>
                    <button class="btn-secondary" onclick="loadDiagrams()"><i class="fa-solid fa-sync"></i>
                        Obnovit</button>
                </div>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Název</th>
                        <th>Typ</th>
                        <th>Na tahu</th>
                        <th>Vytvořeno</th>
                        <th>Akce</th>
                    </tr>
                </thead>
                <tbody id="diagramsTableBody"></tbody>
            </table>
            <div id="noDiagramsInfo"
                style="text-align: center; padding: 2rem; color: var(--text-muted); display: none;">
                Žádné diagramy. <a href="/game-recorder.html" style="color: var(--primary-color);">Vytvořte nový
                    diagram</a>
            </div>
        </div>
    </div>
    <!-- Blicak Registrations View -->
    <div id="blicakView" class="hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h2 style="margin: 0;"><i class="fa-solid fa-bolt"></i>Registrace - Vánoční blesk</h2>
            <button class="btn-primary" onclick="loadBlicakRegistrations()"><i
                    class="fa-solid fa-sync"></i>Obnovit</button>
        </div>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Jméno</th>
                    <th>Oddíl</th>
                    <th>LOK</th>
                    <th>Ročník</th>
                    <th>Čas registrace</th>
                </tr>
            </thead>
            <tbody id="blicakTableBody"></tbody>
        </table>
        <div id="noBlicakInfo" style="text-align: center; padding: 2rem; color: var(--text-muted); display: none;">
            Žádné registrace. </div>

        <!-- Blicák Gallery Management -->
        <div style="margin-top: 3rem; border-top: 1px solid var(--editor-border); padding-top: 2rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h3 style="margin: 0;"><i class="fa-solid fa-camera"></i> Fotografie z turnaje</h3>
                <button class="btn-primary" onclick="document.getElementById('blicakUploadInput').click()">
                    <i class="fa-solid fa-cloud-arrow-up"></i> Nahrát fotky
                </button>
                <input type="file" id="blicakUploadInput" multiple accept="image/*" style="display: none;"
                    onchange="handleAdminGalleryUpload(this, 'blicak').then(() => showToast('Fotky nahrány', 'success'))">
            </div>
            <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 1rem;">
                Zde nahrané fotografie se automaticky zařadí do kategorie "blicak" a zobrazí se v galerii na stránce
                turnaje.
            </p>
        </div>
    </div>
    <!-- Competitions View -->
    <div id="competitionsView" class="hidden">
        <div class="card"
            style="margin-bottom: 2rem; padding: 1.5rem; background: linear-gradient(135deg, var(--card-bg), rgba(59, 130, 246, 0.1)); border-left: 4px solid #3b82f6;">
            <div
                style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                <div style="width: 100%;">
                    <h3 style="margin: 0 0 0.5rem 0; color: #3b82f6;"><i class="fa-solid fa-table"></i>Tabulky družstva
                    </h3>
                    <p style="margin: 0; color: var(--text-muted); font-size: 0.9rem;">Správa
                        zdrojů dat pro soutěže. Změny se projeví po kliknutí na "Aktualizovat
                        tabulky" .</p>
                    <div style="display: flex; justify-content: flex-end; margin-top: 1rem;">
                        <button class="btn-secondary" onclick="updateStandings()" id="updateStandingsBtn"><i
                                class="fa-solid fa-sync"></i>Aktualizovat
                            tabulky </button>
                    </div>
                    <div id="competitionsList" style="margin-top: 1rem;"></div>
                </div>
            </div>
            <div id="standingsResult" style="margin-top: 1rem; display: none;"></div>
        </div>
    </div>
    <!-- Events Management View -->
    <div id="eventsView" class="hidden">
        <div
            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;">
            <h2 style="margin: 0;"><i class="fa-regular fa-calendar-days"></i>Správa událostí</h2>
            <button class="btn-secondary" onclick="AdminEvents.loadEvents()"><i
                    class="fa-solid fa-sync"></i>Obnovit</button>
        </div>

        <!-- Events Form -->
        <div class="card" style="margin-bottom: 2rem;">
            <h3 id="event-form-title" style="margin-top: 0; color: var(--primary-color);"><i
                    class="fa-solid fa-plus"></i>Nová událost</h3>
            <form id="event-form">
                <div class="editor-layout">
                    <!-- Main Content -->
                    <div class="editor-main">
                        <div class="form-group">
                            <label>Název události *</label>
                            <input type="text" name="title" required placeholder="např. Vánoční rapid">
                        </div>
                        <div class="form-group">
                            <label>Popis</label>
                            <textarea name="description" rows="5" placeholder="Podrobnosti o události..."></textarea>
                        </div>

                        <h4
                            style="margin: 1.5rem 0 1rem; color: var(--text-muted); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em;">
                            Čas a Místo</h4>

                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div class="form-group">
                                <label>Začátek *</label>
                                <input type="datetime-local" name="startDate" required>
                            </div>
                            <div class="form-group">
                                <label>Konec</label>
                                <input type="datetime-local" name="endDate">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Místo konání</label>
                            <div class="autocomplete-wrapper" style="position: relative;">
                                <input type="text" name="location" id="eventLocationInput"
                                    placeholder="např. Hala Bižuterie, Jablonec n.N." autocomplete="off">
                                <div id="locationSuggestions" class="suggestions-list"></div>
                            </div>
                        </div>

                        <h4
                            style="margin: 1.5rem 0 1rem; color: var(--text-muted); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em;">
                            Odkazy a Kontakt</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>Kontakt</label>
                                <input type="text" name="organizerContact" placeholder="Email, telefon">
                            </div>
                            <div class="form-group">
                                <label>Web / Odkaz na propozice</label>
                                <input type="text" name="url" placeholder="https://...">
                            </div>

                        </div>

                        <div class="form-group" style="margin-top: 2rem;">
                            <button type="submit" class="btn-primary"
                                style="width: 100%; justify-content: center; padding: 1rem;"><i
                                    class="fa-solid fa-save"></i> Uložit událost</button>
                            <button type="button" id="event-cancel-btn" class="btn-secondary"
                                style="width: 100%; justify-content: center; margin-top: 0.5rem; display: none;"><i
                                    class="fa-solid fa-times"></i> Zrušit úpravy</button>
                        </div>
                    </div>

                    <!-- Sidebar Content -->
                    <div class="editor-sidebar">
                        <h4 style="margin-top: 0; margin-bottom: 1rem; color: var(--primary-color);">Nastavení</h4>

                        <div class="form-group">
                            <label>Kategorie</label>
                            <select name="category" required>
                                <option value="tournament">Turnaj</option>
                                <option value="training">Trénink</option>
                                <option value="camp">Soustředění</option>
                                <option value="meeting">Schůze</option>
                                <option value="other">Ostatní</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Věková kategorie</label>
                            <select name="ageGroup">
                                <option value="">-- Nespecifikováno --</option>
                                <option value="youth">Mládež</option>
                                <option value="adults">Dospělí</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Typ události</label>
                            <select name="eventType">
                                <option value="">-- Nespecifikováno --</option>
                                <option value="individual">Jednotlivci</option>
                                <option value="team">Družstva</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Tempo hry</label>
                            <select name="timeControl">
                                <option value="">-- Nespecifikováno --</option>
                                <option value="blitz">Blitz</option>
                                <option value="rapid">Rapid</option>
                                <option value="classical">Vážný šach</option>
                            </select>
                        </div>

                        <div class="divider" style="height: 1px; background: rgba(255,255,255,0.1); margin: 1.5rem 0;">
                        </div>

                        <h4 style="margin-bottom: 1rem; color: var(--text-color); font-size: 0.9rem;">Registrace</h4>

                        <div class="form-group">
                            <label>Přihlášky do</label>
                            <input type="datetime-local" name="registrationDeadline">
                        </div>
                        <div class="form-group">
                            <label>Konec prezence</label>
                            <input type="datetime-local" name="presentationEnd">
                        </div>
                        <div class="form-group">
                            <label>Startovné</label>
                            <input type="text" name="entryFee" placeholder="např. 100 Kč">
                        </div>

                        <div class="form-group"
                            style="margin-top: 1rem; background: rgba(255,255,255,0.02); padding: 0.75rem; border-radius: 6px; border: 1px solid rgba(255,255,255,0.05);">
                            <label
                                style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; margin: 0;">
                                <input type="checkbox" name="isInternal" style="width: auto;">
                                <span style="font-weight: normal;">Pouze pro členy (interní)</span>
                            </label>
                        </div>
                    </div>
                </div>

            </form>
        </div>

        <!-- Events Table -->
        <div class="card">
            <h3 style="margin-top: 0;"><i class="fa-solid fa-list"></i>Seznam událostí</h3>

            <!-- Desktop Table -->
            <div class="desktop-view">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Datum</th>
                            <th>Název</th>
                            <th>Kategorie</th>
                            <th>Tagy</th>
                            <th>Místo</th>
                            <th>Akce</th>
                        </tr>
                    </thead>
                    <tbody id="events-table-body"></tbody>
                </table>
            </div>

            <!-- Mobile List (Cards) -->
            <div id="events-mobile-list" class="mobile-view"></div>

        </div>
    </div>
    <!-- Puzzle Racer Settings View -->
    <div id="puzzleRacerView" class="hidden">
        <div class="card">
            <div
                style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                <div style="width: 100%;">
                    <h3 style="margin: 0 0 0.5rem 0; color: #3b82f6;"><i class="fa-solid fa-puzzle-piece"></i>Puzzle
                        Racer - Nastavení
                    </h3>
                    <p style="margin: 0; color: var(--text-muted); font-size: 0.9rem;">
                        Konfigurace herních parametrů. Změny se projeví při dalším spuštění
                        hry.</p>
                    <div id="puzzleRacerSettingsForm">
                        <div class="settings-grid">
                            <!-- Helper: General Settings -->
                            <div class="settings-card">
                                <h4><i class="fa-solid fa-sliders"></i>Obecné nastavení
                                </h4>
                                <div class="form-group"><label>Téma úloh</label><select id="prTheme">
                                        <option value="mix">Smíšené (Doporučeno)
                                        </option>
                                        <option value="opening">Zahájení</option>
                                        <option value="middlegame">Střední hra</option>
                                        <option value="endgame">Koncovka</option>
                                        <option value="rookEndgame">Věžová koncovka
                                        </option>
                                        <option value="bishopEndgame">Střelcová koncovka
                                        </option>
                                        <option value="pawnEndgame">Pěšcová koncovka
                                        </option>
                                        <option value="knightEndgame">Jezdcová koncovka
                                        </option>
                                        <option value="queenEndgame">Dámová koncovka
                                        </option>
                                        <optgroup label="Zahájení (nad 10k)">
                                            <option value="sicilianDefense">Sicilská obrana</option>
                                            <option value="queensGambit">Dámský gambit</option>
                                            <option value="kingsIndianDefense">Královská indická</option>
                                            <option value="frenchDefense">Francouzská obrana</option>
                                            <option value="caroKannDefense">Caro-Kann</option>
                                            <option value="ruyLopez">Španělská hra</option>
                                            <option value="italianGame">Italská hra</option>
                                            <option value="scandinavianDefense">Skandinávská obrana</option>
                                            <option value="englishOpening">Anglická hra</option>
                                            <option value="slavDefense">Slovanská obrana</option>
                                            <option value="philidorDefense">Philidorova obrana</option>
                                            <option value="nimzoIndianDefense">Nimcovičova indická</option>
                                            <option value="queensPawnGame">Hra dámským pěšcem</option>
                                            <option value="kingsGambit">Královský gambit</option>
                                            <option value="scotchGame">Skotská hra</option>
                                            <option value="modernDefense">Moderní obrana</option>
                                        </optgroup>
                                    </select></div>
                                <div class="form-group"><label>Časový limit
                                        (sekundy)</label><input type="number" id="prTimeLimit" min="30" max="600"
                                        value="180">
                                </div>
                                <div class="form-group"><label>Puzzlů na úroveň
                                        obtížnosti</label><input type="number" id="prPuzzlesPerDifficulty" min="1"
                                        max="20" value="6">
                                </div>
                            </div>
                            <!-- Helper: Difficulty & Behavior -->
                            <div class="settings-card">
                                <h4><i class="fa-solid fa-heart-crack"></i>Obtížnost a Chyby</h4>

                                <!-- Lives -->
                                <div class="control-row">
                                    <label>Systém životů</label>
                                    <label class="switch">
                                        <input type="checkbox" id="prLivesEnabled" checked>
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                                <div id="prMaxLivesGroup" class="form-group" style="margin-top: 0.5rem;">
                                    <label>Počet životů</label>
                                    <input type="number" id="prMaxLives" min="1" max="10" value="3">
                                </div>

                                <div class="divider"
                                    style="margin: 1rem 0; background: rgba(255,255,255,0.1); height: 1px;"></div>

                                <!-- Randomize -->
                                <div class="control-row">
                                    <label>Náhodné úlohy</label>
                                    <label class="switch">
                                        <input type="checkbox" id="prRandomizePuzzles" checked
                                            onchange="togglePrRandomizeUI()">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                                <p style="font-size: 0.8rem; color: #888; margin-top: 0.2rem; margin-bottom: 0.5rem;">
                                    Pokud vypnuto, všichni hráči dostanou stejnou sadu úloh.
                                </p>
                                <button id="prRefreshSetBtn" class="btn-secondary" onclick="refreshPrFixedSet()"
                                    style="display: none; width: 100%; font-size: 0.85rem; margin-top: 0.5rem;">
                                    <i class="fa-solid fa-rotate"></i> Vygenerovat novou sadu
                                </button>

                                <div class="divider"
                                    style="margin: 1rem 0; background: rgba(255,255,255,0.1); height: 1px;"></div>

                                <!-- Penalty -->
                                <div class="control-row">
                                    <label>Časová penalizace</label>
                                    <label class="switch">
                                        <input type="checkbox" id="prPenaltyEnabled">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                                <div id="prPenaltySecondsGroup" class="form-group"
                                    style="margin-top: 0.5rem; display: none;">
                                    <label>Sekundy penalizace</label>
                                    <input type="number" id="prPenaltySeconds" min="1" max="60" value="5">
                                </div>

                                <div class="divider"
                                    style="margin: 1rem 0; background: rgba(255,255,255,0.1); height: 1px;"></div>

                                <!-- Skip on Mistake -->
                                <div class="control-row">
                                    <label>Přeskočit po chybě</label>
                                    <label class="switch">
                                        <input type="checkbox" id="prSkipOnMistake">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: flex-end; margin-top: 1.5rem;">
                        <button class="btn-primary" onclick="savePuzzleRacerSettings()" id="savePrSettingsBtn"><i
                                class="fa-solid fa-save"></i>Uložit
                            nastavení </button>
                    </div>
                    <div id="prSettingsResult" style="margin-top: 1rem; text-align: center;">
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <!-- Gallery View -->
    <div id="galleryView" class="hidden">
        <div class="header-actions">
            <h2><i class="fa-regular fa-images"></i>Správa Galerie</h2>
            <!-- Gallery Toolbar -->
            <div class="panel-section"
                style="margin-top: 0; background: var(--surface-color); border: none; padding: 0 0 1.5rem 0;">
                <div
                    style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; justify-content: space-between;">
                    <div style="display: flex; gap: 1rem; align-items: center;">
                        <div class="file-upload-btn"
                            style="position: relative; overflow: hidden; display: inline-block;">
                            <button class="btn-primary" style="display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fa-solid fa-cloud-arrow-up"></i> Nahrát obrázky
                            </button>
                            <input type="file" id="adminGalleryUpload" multiple accept="image/*"
                                onchange="handleAdminGalleryUpload(this)"
                                style="position: absolute; left: 0; top: 0; opacity: 0; width: 100%; height: 100%; cursor: pointer;">
                        </div>

                        <select id="galleryCategoryFilter" onchange="loadAdminGallery(1)"
                            style="width: auto; padding: 0.6rem;">
                            <option value="">Všechny kategorie</option>
                            <option value="news">Novinky</option>
                            <option value="members">Členové</option>
                            <option value="intro">Úvodní</option>
                            <option value="blicak">Bličáky</option>
                        </select>
                    </div>

                    <!-- Batch Actions -->
                    <div id="batchActionsBar"
                        style="display: flex; gap: 0.5rem; align-items: center; opacity: 0.5; pointer-events: none; transition: opacity 0.2s;">
                        <span style="font-size: 0.9rem; color: var(--text-muted); margin-right: 0.5rem;">
                            Vybráno: <span id="selectedCount"
                                style="color: var(--text-color); font-weight: bold;">0</span>
                        </span>

                        <select id="batchCategorySelect" style="width: auto; padding: 0.4rem; font-size: 0.85rem;">
                            <option value="">Změnit kategorii...</option>
                        </select>
                        <button class="btn-secondary btn-small" onclick="applyBatchCategory()">
                            <i class="fa-solid fa-check"></i>
                        </button>

                        <div style="width: 1px; height: 20px; background: var(--editor-border); margin: 0 0.5rem;">
                        </div>

                        <button id="batchDeleteBtn" class="btn-delete btn-small" onclick="deleteSelectedImages()">
                            <i class="fa-solid fa-trash"></i> Smazat
                        </button>
                    </div>
                </div>
            </div>

            <!-- Gallery Grid -->
            <div style="margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                <input type="checkbox" id="selectAllGallery" onchange="toggleSelectAllGallery(this)">
                <label for="selectAllGallery"
                    style="cursor: pointer; font-size: 0.9rem; color: var(--text-muted);">Vybrat vše na stránce</label>
            </div>

            <div id="galleryGrid" class="gallery-grid"
                style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1.5rem; min-height: 200px;">
                <!-- Items will be injected here -->
            </div>

            <!-- Pagination -->
            <div id="galleryPagination"
                style="display: flex; justify-content: center; align-items: center; gap: 1rem; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--editor-border);">
                <!-- Pagination controls -->
            </div>


        </div>
    </div>
    </div>
    </div>
    <!-- Chess Database View -->
    <div id="chessdbView" class="hidden">
        <h2><i class="fa-solid fa-database"></i> Šachová databáze</h2>
        <p style="color: var(--text-muted); margin-bottom: 1.5rem;">
            Import partií z PGN souborů do databáze. Duplicity (stejný bílý, černý, datum, turnaj, výsledek) budou
            přeskočeny.
        </p>

        <div class="card" style="margin-bottom: 1.5rem;">
            <h3 style="margin-bottom: 1rem;"><i class="fa-solid fa-chart-bar"></i> Statistiky</h3>
            <div id="chessdbStats" style="display: flex; gap: 2rem; flex-wrap: wrap;">
                <div style="text-align: center;">
                    <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);" id="totalGamesCount">-
                    </div>
                    <div style="color: var(--text-muted); font-size: 0.85rem;">Celkem partií</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 2rem; font-weight: 700; color: #4ade80;" id="totalPlayersCount">-</div>
                    <div style="color: var(--text-muted); font-size: 0.85rem;">Hráčů</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3 style="margin-bottom: 1rem;"><i class="fa-solid fa-file-import"></i> Import PGN</h3>
            <textarea id="pgnImportText" rows="12" placeholder="Vložte PGN notaci zde...
[Event &quot;Turnaj&quot;]
[White &quot;Bílý&quot;]
[Black &quot;Černý&quot;]
[Result &quot;1-0&quot;]

1. e4 e5 2. Nf3 Nc6..."
                style="width: 100%; padding: 1rem; background: #0a0a0a; border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: #e0e0e0; font-family: monospace; font-size: 0.9rem; resize: vertical;"></textarea>

            <div id="pgnImportResult" style="display: none; margin-top: 1rem; padding: 1rem; border-radius: 6px;"></div>

            <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                <button onclick="importChessGames()" class="btn-primary" id="importPgnBtn">
                    <i class="fa-solid fa-upload"></i> Importovat partie
                </button>
                <button onclick="document.getElementById('pgnFileInput').click()" class="btn-secondary">
                    <i class="fa-solid fa-file"></i> Nahrát soubor
                </button>
                <input type="file" id="pgnFileInput" accept=".pgn" style="display: none;" onchange="loadPgnFile(this)">
            </div>
        </div>

        <div class="card" style="margin-top: 1.5rem;">
            <h3 style="margin-bottom: 1rem; color: #f59e0b; margin-top: 0;"><i
                    class="fa-solid fa-triangle-exclamation"></i> Kontrola duplicit</h3>
            <p style="color: var(--text-muted); margin-bottom: 1rem; font-size: 0.9rem;">
                Hledá partie se stejným bílým, černým a datem. Vhodné pro kontrolu integrity databáze.
            </p>
            <button onclick="checkDuplicateGames()" class="btn-secondary">
                <i class="fa-solid fa-search"></i> Zkontrolovat duplicity
            </button>
            <div id="duplicateCheckResult" style="display: none; margin-top: 1rem; padding: 1rem; border-radius: 6px;">
            </div>
        </div>
    </div>
    <!-- Changelog View -->
    <div id="changelogView" class="hidden">
        <!-- Roadmap Section -->
        <div class="card" style="margin-bottom: 2rem; border-left: 4px solid #10b981;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                <i class="fa-solid fa-map" style="font-size: 1.5rem; color: #10b981;"></i>
                <h2 style="margin: 0; color: #10b981;">Roadmap</h2>
            </div>
            <p style="color: var(--text-muted); margin-bottom: 1rem; font-size: 0.9rem;">Plánované funkce a prioritní
                úkoly</p>

            <div style="display: grid; gap: 0.75rem;">
                <div
                    style="display: flex; gap: 1rem; padding: 0.75rem 1rem; background: rgba(16,185,129,0.1); border-radius: 8px;">
                    <span
                        style="background: #10b981; color: #000; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.7rem; font-weight: 600; height: fit-content;">P1</span>
                    <div>
                        <strong style="font-size: 0.9rem;">Admin panel redesign</strong>
                        <p style="margin: 0.2rem 0 0; font-size: 0.8rem; color: var(--text-muted);">Dashboard, sidebar
                            navigace, modularizace admin-news.js ✅</p>
                    </div>
                </div>
                <div
                    style="display: flex; gap: 1rem; padding: 0.75rem 1rem; background: rgba(34,197,94,0.1); border-radius: 8px;">
                    <span
                        style="background: #22c55e; color: #fff; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.7rem; font-weight: 600; height: fit-content;">✓</span>
                    <div>
                        <strong style="font-size: 0.9rem;">Rozšíření členské sekce</strong>
                        <p style="margin: 0.2rem 0 0; font-size: 0.8rem; color: var(--text-muted);">Interní oznámení,
                            dokumenty, diskuzní fórum</p>
                        <p style="margin: 0.2rem 0 0; font-size: 0.75rem; color: #22c55e;">✅ Hotovo - API + modely</p>
                    </div>
                </div>
                <div
                    style="display: flex; gap: 1rem; padding: 0.75rem 1rem; background: rgba(34,197,94,0.1); border-radius: 8px;">
                    <span
                        style="background: #22c55e; color: #fff; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.7rem; font-weight: 600; height: fit-content;">✓</span>
                    <div>
                        <strong style="font-size: 0.9rem;">Email služba</strong>
                        <p style="margin: 0.2rem 0 0; font-size: 0.8rem; color: var(--text-muted);">Reset hesla,
                            notifikace o komentářích, notifikace při registraci</p>
                        <p style="margin: 0.2rem 0 0; font-size: 0.75rem; color: #22c55e;">✅ Hotovo - Resend API</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Changelog Card -->
        <div class="card" style="margin-bottom: 2rem;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                <i class="fa-solid fa-code-branch" style="font-size: 2rem; color: var(--primary-color);"></i>
                <div>
                    <h2 style="margin: 0;">Changelog</h2>
                    <p style="margin: 0.25rem 0 0; color: var(--text-muted); font-size: 0.9rem;">Historie změn a
                        aktualizací webu</p>
                </div>
            </div>

            <div class="changelog-timeline">
                <!-- 2026-01-22 v23 -->
                <div class="changelog-entry">
                    <div class="changelog-date">22. 1. 2026</div>
                    <div class="changelog-version">v23</div>
                    <div class="changelog-content">
                        <h4>📱 Diagramy - Mobilní vylepšení</h4>
                        <ul>
                            <li><strong>Responsivní design:</strong> Plná šířka šachovnice na mobilech (≤600px) pro
                                lepší ovládání.</li>
                            <li><strong>Desktop layout:</strong> Diagram plovoucí vpravo (400px) s obtékáním textu.</li>
                            <li><strong>Lichess-style tolerance:</strong> Pixel-based práh (15px) pro rozlišení kliknutí
                                od tahu.</li>
                            <li><strong>Micro-drag ochrana:</strong> Rychlé přetažení na sousední políčko zachová výběr
                                místo jeho zrušení.</li>
                        </ul>
                    </div>
                </div>
                <!-- 2026-01-20 v22 -->
                <div class="changelog-entry">
                    <div class="changelog-date">20. 1. 2026</div>
                    <div class="changelog-version">v22</div>
                    <div class="changelog-content">
                        <h4>♟️ Diagramy - Finalizace a Opravy</h4>
                        <ul>
                            <li><strong>Interakce:</strong> Kompletní oprava tahání figurek - spolehlivé Click-to-Move i
                                Drag-and-Drop.</li>
                            <li><strong>Vizuál:</strong> Oprava "ghosting" efektu (mikrodrag) a sjednocení zvýraznění
                                polí (styl Puzzle Racer).</li>
                            <li><strong>Editor:</strong> Odstraněn redundantní přepínač tahu (automatická detekce z
                                pozice).</li>
                            <li><strong>Editor:</strong> Oprava scrollování v modálním okně editoru na menších
                                obrazovkách.</li>
                            <li><strong>Viewer:</strong> Robustní synchronizace stavu hry a vylepšená validace tahů.
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- 2026-01-19 v21 -->
                <div class="changelog-entry">
                    <div class="changelog-date">19. 1. 2026</div>
                    <div class="changelog-version">v21</div>
                    <div class="changelog-content">
                        <h4>🔧 Opravy & Vylepšení</h4>
                        <ul>
                            <li><strong>Partie:</strong> Oprava ukládání vlastních partií pro přihlášené členy (Game
                                Recorder).</li>
                            <li><strong>Tabulky:</strong> Oprava načítání výsledků B týmu (KP Liberec) z Chess-Results.
                            </li>
                            <li><strong>Diagramy:</strong> Vylepšení "Knihy Diagramů" - 3D animace otáčení, čtvercový
                                formát, editovatelné popisky.</li>
                        </ul>
                    </div>
                </div>
                <!-- 2026-01-18 v20 -->
                <div class="changelog-entry">
                    <div class="changelog-date">18. 1. 2026</div>
                    <div class="changelog-version">v20</div>
                    <div class="changelog-content">
                        <h4>♟️ Šachová databáze - Engine analýza</h4>
                        <ul>
                            <li><strong>Engine integrace:</strong> Lichess Cloud API + chess-api.com fallback</li>
                            <li><strong>Eval bar:</strong> Vertikální teploměr vedle šachovnice</li>
                            <li><strong>Figurková notace:</strong> ♞f6, ♗g2 místo Nf6, Bg2</li>
                            <li><strong>Čísla tahů:</strong> 1. e4 e5 2. ♞f3 formát v PV linii</li>
                            <li><strong>Toggle engine:</strong> Zapnutí/vypnutí enginu tlačítkem</li>
                            <li><strong>Hloubka analýzy:</strong> Nastavitelná v Admin → Hry (10-20)</li>
                        </ul>
                        <h4>🔧 Vylepšení databáze</h4>
                        <ul>
                            <li><strong>URL persistence:</strong> Vybraný hráč přetrvá refresh (?player=...)</li>
                            <li><strong>Autoplay scroll:</strong> Scroll tahů nehýbe celou stránkou</li>
                            <li><strong>ChessDB PGN import:</strong> Oprava chess.js API (loadPgn)</li>
                        </ul>
                    </div>
                </div>

                <!-- 2026-01-12 v19 -->
                <div class="changelog-entry">
                    <div class="changelog-date">12. 1. 2026</div>
                    <div class="changelog-version">v19</div>
                    <div class="changelog-content">
                        <h4>📧 Email notifikace</h4>
                        <ul>
                            <li><strong>Komentáře:</strong> Autor článku dostane email při novém komentáři</li>
                            <li><strong>Registrace:</strong> Admini dostanou email při registraci nového uživatele</li>
                            <li><strong>Cestovní příkazy:</strong> Email uživateli při schválení/zamítnutí příkazu</li>
                            <li><strong>Resend API:</strong> Migrace z SMTP na Resend (Railway blokuje SMTP porty)</li>
                        </ul>
                        <h4>👤 Uživatelé</h4>
                        <ul>
                            <li><strong>Poslední přihlášení:</strong> Sledování data posledního přihlášení uživatelů
                            </li>
                        </ul>
                        <h4>🛠️ Utility</h4>
                        <ul>
                            <li><strong>Toast notifikace:</strong> Globální systém pro frontend notifikace</li>
                            <li><strong>Auth toasty:</strong> Notifikace při přihlášení, odhlášení a registraci</li>
                        </ul>
                        <h4>💬 Diskuzní fórum</h4>
                        <ul>
                            <li><strong>Témata:</strong> CRUD API pro vytváření, čtení, mazání témat</li>
                            <li><strong>Příspěvky:</strong> Odpovídání na témata</li>
                            <li><strong>Admin:</strong> Připínání, zamykání a mazání témat</li>
                        </ul>
                        <h4>🔧 Admin</h4>
                        <ul>
                            <li><strong>Cestovní příkazy:</strong> API pro schvalování/zamítání + přehled všech</li>
                        </ul>
                    </div>
                </div>

                <!-- 2026-01-11 v18 -->
                <div class="changelog-entry">
                    <div class="changelog-date">11. 1. 2026</div>
                    <div class="changelog-version">v18</div>
                    <div class="changelog-content">
                        <h4>👥 Členská sekce - Velký refaktoring</h4>
                        <ul>
                            <li><strong>Dashboard Hub:</strong> Nový přehledný dashboard s 6 dlaždicemi (Nástěnka,
                                Partie, Puzzle Racer, Galerie, Databáze, Kniha Přání)</li>
                            <li><strong>Nástěnka:</strong> Konsolidace "Vzkazovník" a "Aktuality" do jedné sekce s taby
                                (Oznámení, Dokumenty, Cestovní příkazy, Vzkazy)</li>
                            <li><strong>Layout:</strong> Optimalizace - dlaždice viditelné "nad foldem", info box
                                přesunut níže</li>
                            <li><strong>Navigace:</strong> Přidána tlačítka "Zpět" do Puzzle Racer a Databáze</li>
                        </ul>
                        <h4>📧 Email služby</h4>
                        <ul>
                            <li><strong>Reset hesla:</strong> Implementován kompletní flow - frontend modal, backend
                                API, emailové notifikace</li>
                            <li><strong>Notifikace:</strong> Automatický email adminům při novém cestovním příkazu</li>
                            <li><strong>Mailer:</strong> Integrace Nodemailer s SMTP (mail.webglobe.cz)</li>
                        </ul>
                        <h4>🔧 Opravy</h4>
                        <ul>
                            <li><strong>Partie:</strong> Odkaz vede na /partie místo member-games.html</li>
                            <li><strong>Databáze:</strong> Oprava odkazu na chess-database.html</li>
                            <li><strong>Padding:</strong> Redukce horního odsazení stránky</li>
                            <li><strong>Logout:</strong> Odstraněno duplicitní tlačítko z dashboardu (je v globálním
                                menu)</li>
                        </ul>
                    </div>
                </div>
                <!-- 2026-01-05 v17 -->
                <div class="changelog-entry">
                    <div class="changelog-date">5. 1. 2026</div>
                    <div class="changelog-version">v17</div>
                    <div class="changelog-content">
                        <h4>📅 Události & Mapy</h4>
                        <ul>
                            <li><strong>Nové turnaje:</strong> Přidány turnaje pro Leden-Květen 2026 (Josefův Důl,
                                Varnsdorf, Bakov, Praha Open, PORG Open).</li>
                            <li><strong>Mapy:</strong> Vylepšeno zobrazení mapy ČR (SVG), přidány souřadnice, zoom pro
                                Liberecký kraj.</li>
                            <li><strong>Vzdálenost:</strong> Automatický výpočet vzdušné vzdálenosti od Jablonce v
                                detailu události.</li>
                            <li><strong>Filtry:</strong> Oprava filtrování dospělých (zobrazuje i open turnaje pro
                                všechny).</li>
                        </ul>
                    </div>
                </div>
                <!-- 2025-12-30 v16 -->
                <div class="changelog-entry">
                    <div class="changelog-date">30. 12. 2025</div>
                    <div class="changelog-version">v16</div>
                    <div class="changelog-content">
                        <h4>📱 Mobilní zobrazení</h4>
                        <ul>
                            <li><strong>Tabulky:</strong> Prioritizace "Konečného pořadí" na mobilu (přesun nahoru).
                            </li>
                            <li><strong>Křížová tabulka:</strong> Na mobilu ve výchozím stavu sbalená (Collapsible),
                                fixní první sloupec při scrollování.</li>
                        </ul>
                        <h4>✏️ Admin Editor</h4>
                        <ul>
                            <li><strong>Undo/Redo:</strong> Přidána tlačítka Zpět/Vpřed do panelu nástrojů editoru.</li>
                        </ul>
                    </div>
                </div>
                <!-- 2025-12-27 v15 -->
                <div class="changelog-entry">
                    <div class="changelog-date">27. 12. 2025</div>
                    <div class="changelog-version">v15</div>
                    <div class="changelog-content">
                        <h4>🏠 Homepage</h4>
                        <ul>
                            <li><strong>3D Rotující dlaždice:</strong> Nová interaktivní dlaždice "Rozpis zápasů" s
                                automatickou rotací (A, B, C, D týmy).</li>
                            <li><strong>2x2 Mřížka:</strong> Obnoveno klasické rozložení navigace (šachovnicový vzor).
                            </li>
                            <li><strong>Layout:</strong> Fixní prostor pro widget (bez poskakování), zalomení nadpisu.
                            </li>
                        </ul>
                        <h4>📅 Kalendář zápasů</h4>
                        <ul>
                            <li><strong>JS Refactoring:</strong> Přesun inline JS do <code>js/calendar.js</code> (oprava
                                Unexpected EOF).</li>
                            <li><strong>Deep linking:</strong> Auto-scroll a zvýraznění zápasu, auto-expand detailu.
                            </li>
                            <li><strong>Quote escaping:</strong> Oprava názvů týmů s uvozovkami ("B", "C").</li>
                            <li><strong>Volno:</strong> Bye zápasy již nejsou klikatelné.</li>
                            <li><strong>Tlačítko Turnaje:</strong> Zmenšeno pro mobilní zobrazení.</li>
                        </ul>
                        <h4>👥 Soupisky</h4>
                        <ul>
                            <li><strong>Mládež:</strong> Přidána mapování pro mládežnické týmy (1. liga mládeže A, KPM).
                            </li>
                            <li><strong>Escapování:</strong> Oprava zobrazení soupisek s uvozovkami v názvech.</li>
                        </ul>
                    </div>
                </div>
                <!-- 2025-12-26 v14 -->
                <div class="changelog-entry">
                    <div class="changelog-date">26. 12. 2025</div>
                    <div class="changelog-version">v14</div>
                    <div class="changelog-content">
                        <h4>🆕 Nové funkce</h4>
                        <ul>
                            <li><strong>Šachová databáze:</strong> Import PGN pro adminy (detekce duplicit), statistiky,
                                řazení (Datum, ECO)</li>
                            <li><strong>Členská sekce:</strong> Kniha přání (Wishlist), přejmenování "Příprava" na
                                "Databáze"</li>
                        </ul>
                        <h4>🔧 Opravy & Vylepšení</h4>
                        <ul>
                            <li><strong>Databáze:</strong> Oprava zobrazení na mobilech (výška šachovnice, scrollování),
                                sjednocení hlavičky</li>
                            <li><strong>Databáze:</strong> Automatické přepínání barvy stromu, optimalizace plynulosti
                                přehrávání, scroll-to-move</li>
                            <li><strong>Footer:</strong> Kompaktnější vzhled, přidán odkaz na "Tréninky od Karla"</li>
                            <li><strong>Kalendář:</strong> Oprava zarovnání ikony Google Calendar</li>
                            <li><strong>Systém:</strong> Oprava načítání konfigurace (API_URL chyba)</li>
                            <li><strong>Členská sekce:</strong> Spuštěn testovací provoz - dočasně zpřístupněno všem
                                registrovaným uživatelům (do konce ledna). Přidán info banner.</li>
                            <li><strong>Registrace:</strong> Přidána možnost registrace přes Google přímo v registračním
                                formuláři.</li>
                        </ul>
                    </div>
                </div>
                <!-- 2025-12-26 v14 -->
                <div class="changelog-entry">
                    <div class="changelog-date">26. 12. 2025</div>
                    <div class="changelog-version">v14</div>
                    <div class="changelog-content">
                        <h4>♻️ Velký refaktoring - Tech Debt</h4>
                        <ul>
                            <li><strong>Server.js:</strong> 1546 → 667 řádků (-57%)</li>
                            <li><strong>Admin.html:</strong> 1720 → 1455 řádků, CSS extrahováno</li>
                            <li><strong>Nové moduly:</strong> <code>scrapingService.js</code>,
                                <code>standingsService.js</code>
                            </li>
                            <li><strong>Odstraněn dead code:</strong> <code>scraping_backup.js</code>,
                                <code>temp_update_logic.js</code>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- 2025-12-26 v13 -->
                <div class="changelog-entry">
                    <div class="changelog-date">26. 12. 2025</div>
                    <div class="changelog-version">v13</div>
                    <div class="changelog-content">
                        <h4>🆕 Nové funkce</h4>
                        <ul>
                            <li><strong>Blicák Galerie:</strong> Nasazena nová galerie (61 fotek, WEBP) od Davida
                                Šafaříka</li>
                            <li><strong>Paginace:</strong> Implementováno stránkování galerií v článcích a na stránce
                                turnaje</li>
                        </ul>
                        <h4>♻️ Refaktoring</h4>
                        <ul>
                            <li><strong>admin-news.js:</strong> Kompletní modularizace (rozdělení na Wysiwyg, Images,
                                Thumbnail)</li>
                            <li>Redukce velikosti hlavního souboru o ~43% (odstranění duplicitního kódu)</li>
                        </ul>
                    </div>
                </div>
                <!-- 2025-12-26 -->
                <div class="changelog-entry">
                    <div class="changelog-date">26. 12. 2025</div>
                    <div class="changelog-version">v12</div>
                    <div class="changelog-content">
                        <h4>🔧 Opravy</h4>
                        <ul>
                            <li><strong>Admin panel:</strong> Opravena inicializace - duplicitní deklarace
                                <code>API_URL</code> a <code>selectedImage</code>
                            </li>
                            <li><strong>Admin panel:</strong> Opravena race condition při <code>DOMContentLoaded</code>
                            </li>
                            <li><strong>Login tlačítko:</strong> Opraveno zobrazení na stránce "O nás" - chyběly auth
                                skripty</li>
                            <li><strong>Uživatelé:</strong> Opravena chyba při načítání (403 error handling)</li>
                            <li><strong>Role middleware:</strong> Case-insensitive kontrola (SUPERADMIN == superadmin)
                            </li>
                        </ul>
                        <h4>🆕 Nové funkce</h4>
                        <ul>
                            <li><strong>Changelog:</strong> Přidána sekce Changelog do admin panelu</li>
                            <li><strong>Verzování:</strong> Centralizované verzování přes <code>version.js</code> -
                                APP_VERSION</li>
                        </ul>
                        <h4>♻️ Refaktoring</h4>
                        <ul>
                            <li>Extrakce <code>utils.js</code> - společné utility funkce (escapeHtml, debounce,
                                throttle)</li>
                            <li>Extrakce admin modulů: <code>admin-users.js</code>, <code>admin-blicak.js</code>,
                                <code>admin-puzzle-racer.js</code>
                            </li>
                            <li>Snížení inline JS v admin.html z ~640 na ~60 řádků</li>
                        </ul>
                    </div>
                </div>

                <!-- 2025-12-25 -->
                <div class="changelog-entry">
                    <div class="changelog-date">25. 12. 2025</div>
                    <div class="changelog-version">v10</div>
                    <div class="changelog-content">
                        <h4>🆕 Nové funkce</h4>
                        <ul>
                            <li><strong>Kalendář událostí:</strong> Kompletní správa událostí - turnaje, tréninky,
                                soustředění</li>
                            <li><strong>Admin Events:</strong> Nový modul pro správu kalendáře v admin panelu</li>
                            <li><strong>Event tags:</strong> Šachově-specifické tagy (věková kategorie, tempo, typ)</li>
                        </ul>
                        <h4>♻️ Refaktoring</h4>
                        <ul>
                            <li>Separace admin-core.js pro sdílenou funkcionalitu</li>
                            <li>URL hash persistence pro admin taby</li>
                        </ul>
                    </div>
                </div>

                <!-- 2025-12-27 -->
                <div class="changelog-entry">
                    <div class="changelog-date">27. 12. 2025</div>
                    <div class="changelog-version">v9</div>
                    <div class="changelog-content">
                        <h4>🆕 Nové funkce</h4>
                        <ul>
                            <li><strong>Autoři:</strong> Podpora pro autory a spoluautory článků</li>
                            <li><strong>Admin editor:</strong> Výběr autora z registrovaných uživatelů</li>
                            <li><strong>Statistiky:</strong> Počítadlo zobrazení pro články</li>
                            <li><strong>Nastavení:</strong> Možnost volby zobrazovaného jména (Profil / Přezdívka)</li>
                        </ul>
                    </div>
                </div>

                <!-- 2025-12-12 -->
                <div class="changelog-entry">
                    <div class="changelog-date">12. 12. 2025</div>
                    <div class="changelog-version">v8</div>
                    <div class="changelog-content">
                        <h4>🔧 Opravy</h4>
                        <ul>
                            <li><strong>Game Viewer:</strong> Opravena výška šachovnice a notace na mobilu</li>
                            <li><strong>Caching:</strong> Cache busting pro produkční prostředí</li>
                            <li><strong>Server:</strong> Graceful shutdown při deploymentu</li>
                        </ul>
                        <h4>🆕 Nové funkce</h4>
                        <ul>
                            <li><strong>Puzzle Racer:</strong> Rozlišení vanilla/thematic módů</li>
                            <li><strong>Game Recorder:</strong> Nahrávání vlastních partií</li>
                        </ul>
                    </div>
                </div>

                <!-- 2025-12-11 -->
                <div class="changelog-entry">
                    <div class="changelog-date">11. 12. 2025</div>
                    <div class="changelog-version">v7</div>
                    <div class="changelog-content">
                        <h4>🆕 Nové funkce</h4>
                        <ul>
                            <li><strong>Galerie:</strong> Lightbox s navigací mezi fotkami</li>
                            <li><strong>Admin galerie:</strong> Batch operace - mazání více obrázků najednou</li>
                            <li><strong>Captions:</strong> Zobrazení skutečných popisků místo placeholderů</li>
                        </ul>
                    </div>
                </div>

                <!-- Starší -->
                <div class="changelog-entry">
                    <div class="changelog-date">Starší verze</div>
                    <div class="changelog-version">v1-6</div>
                    <div class="changelog-content">
                        <ul>
                            <li>Počáteční vývoj webu</li>
                            <li>Admin panel pro správu novinek</li>
                            <li>WYSIWYG editor</li>
                            <li>Přehrávač partií z Chess.com</li>
                            <li>Puzzle Racer hra</li>
                            <li>Foto galerie s kategoriemi</li>
                            <li>Autentizace a správa uživatelů</li>
                            <li>Blicák turnaj s registrací</li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <!-- Member Modal -->
    <div id="memberModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="width: 500px;">
            <h2 id="memberModalTitle" style="margin-top: 0;">Nový člen</h2><input type="hidden" id="memberId">
            <div class="form-group"><label>Jméno *</label><input type="text" id="memberFirstName" placeholder="Jan">
            </div>
            <div class="form-group"><label>Příjmení *</label><input type="text" id="memberLastName" placeholder="Novák">
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div class="form-group"><label>ELO</label><input type="number" id="memberElo"></div>
                <div class="form-group"><label>Titul</label><input type="text" id="memberTitle" placeholder="Např. FM">
                </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div class="form-group"><label>Rok narození</label><input type="number" id="memberBirthYear"></div>
                <div class="form-group"><label>Role</label><input type="text" id="memberRole"
                        placeholder="Např. Předseda"></div>
            </div>
            <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1rem;">
                <button class="btn-secondary" onclick="closeMemberModal()">Zrušit</button><button class="btn-primary"
                    onclick="saveMember()">Uložit</button>
            </div>
        </div>
    </div>
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/admin/admin-core.js?v=ux12"></script>
    <script src="js/admin/admin-gallery.js?v=ux12"></script>
    <script src="js/admin/admin-wysiwyg.js?v=ux12"></script>
    <script src="js/admin/admin-content-images.js?v=ux12"></script>
    <script src="js/admin/admin-thumbnail.js?v=ux12"></script>
    <script src="js/admin/admin-news.js?v=ux12"></script>
    <script src="js/admin/admin-news-modals.js?v=ux12"></script>
    <script src="js/admin/admin-members.js?v=ux12"></script>
    <script src="js/admin/admin-messages.js?v=ux12"></script>
    <script src="js/admin/admin-competitions.js?v=ux12"></script>
    <script src="js/admin/admin-games.js?v=ux12"></script>
    <script src="js/admin/admin-events.js?v=ux12"></script>
    <script src="js/admin/admin-users.js?v=ux12"></script>
    <script src="js/admin/admin-blicak.js?v=ux12"></script>
    <script src="js/admin/admin-puzzle-racer.js?v=ux12"></script>
    <script src="js/admin/admin-chessdb.js?v=ux12"></script>
    <script src="js/admin/admin-dashboard.js?v=ux12"></script>
    <!-- All admin functionality moved to modular JS files in js/admin/ -->

    <!-- Recorded Games Picker Modal -->
    <div id="recordedGamesModal" class="admin-modal-overlay" style="display: none;">
        <div class="admin-modal-box" style="max-width: 600px;">
            <div class="admin-modal-head">
                <h3><i class="fa-solid fa-database"></i> Vybrat partii z databáze</h3>
                <button onclick="closeRecordedGamesModal()" class="close-btn">&times;</button>
            </div>
            <div id="recordedGamesList" style="max-height: 60vh; overflow-y: auto; padding: 1rem;">
                <p style="color: var(--text-muted); text-align: center;"><i class="fa-solid fa-spinner fa-spin"></i>
                    Načítám...</p>
            </div>
        </div>
    </div>

    <!-- PGN Paste Modal for News Editor -->
    <div id="newsGamePgnModal" class="admin-modal-overlay" style="display: none;">
        <div class="admin-modal-box" style="max-width: 560px;">
            <div class="admin-modal-head">
                <h3 style="color: #4ade80;"><i class="fa-solid fa-file-code"></i> Vložit PGN</h3>
                <button onclick="closeNewsGamePgnModal()" class="close-btn">&times;</button>
            </div>
            <div style="padding: 1.25rem;">
                <p style="color: var(--text-muted); font-size: 0.85rem; margin: 0 0 0.75rem 0;">
                    Vložte PGN nebo nahrajte soubor. Jméno hráčů se načte automaticky.
                </p>

                <!-- Drop zone / textarea -->
                <div id="pgnDropZone" style="position: relative;">
                    <textarea id="newsGamePgnText" rows="10"
                        placeholder="[Event &quot;...&quot;]&#10;[White &quot;Bílý&quot;]&#10;[Black &quot;Černý&quot;]&#10;&#10;1. e4 e5 2. Nf3..."
                        style="width: 100%; font-family: monospace; font-size: 0.85rem; background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; padding: 0.75rem; color: #e0e0e0; resize: vertical;"></textarea>
                    <div id="pgnDropOverlay"
                        style="display: none; position: absolute; inset: 0; background: rgba(16, 185, 129, 0.2); border: 2px dashed #4ade80; border-radius: 6px; align-items: center; justify-content: center; color: #4ade80; font-weight: 600;">
                        <i class="fa-solid fa-file-arrow-down" style="font-size: 2rem;"></i>
                    </div>
                </div>

                <!-- File upload -->
                <div style="display: flex; gap: 0.5rem; margin-top: 0.75rem; align-items: center;">
                    <input type="file" id="pgnFileInput" accept=".pgn,.txt" style="display: none;"
                        onchange="handlePgnFileUpload(event)">
                    <button type="button" class="btn-secondary btn-small"
                        onclick="document.getElementById('pgnFileInput').click()" style="padding: 0.4rem 0.8rem;">
                        <i class="fa-solid fa-upload"></i> Nahrát soubor
                    </button>
                    <span style="font-size: 0.75rem; color: var(--text-muted);">.pgn nebo .txt</span>
                </div>

                <div style="display: flex; gap: 0.5rem; justify-content: flex-end; margin-top: 1rem;">
                    <button onclick="closeNewsGamePgnModal()" class="btn-secondary">Zrušit</button>
                    <button onclick="addGameFromPgn()" class="btn-primary" style="background: #4ade80; color: #000;"><i
                            class="fa-solid fa-plus"></i> Přidat</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Header/Separator Modal -->
    <div id="headerModal" class="admin-modal-overlay" style="display: none;">
        <div class="admin-modal-box" style="max-width: 400px;">
            <div class="admin-modal-head">
                <h3 style="color: var(--primary-color);"><i class="fa-solid fa-heading"></i> Přidat oddělovač</h3>
                <button onclick="closeHeaderModal()" class="close-btn">&times;</button>
            </div>
            <div style="padding: 1.25rem;">
                <input type="text" id="headerTitleModal" placeholder="Např. A tým, B tým..."
                    style="width: 100%; font-size: 0.9rem; padding: 0.5rem;">
                <div style="display: flex; gap: 0.5rem; justify-content: flex-end; margin-top: 1rem;">
                    <button onclick="closeHeaderModal()" class="btn-secondary">Zrušit</button>
                    <button onclick="addHeaderFromModal()" class="btn-primary"><i class="fa-solid fa-plus"></i>
                        Přidat</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin modules already loaded at lines 1762-1767, DO NOT duplicate here -->
    <!-- Legacy Admin Script -->
    <!-- <script src="js/admin.js" defer></script> -->
</body>


</html>