<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>캛l치nek - 마chov칳 odd칤l TJ Bi쬿terie Jablonec</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css"
        integrity="sha384-q94+BZtLrkL1/ohfjR8c6L+A6qzNH9R2hBLwyoAfu3i/WCvQjzL2RQJ3uNHDISdU" crossorigin="anonymous">
    <style>
        .article-header {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-color);
        }

        .article-meta {
            display: flex;
            gap: 1rem;
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }



        .article-content img {
            max-width: 100%;
            height: auto;
            border-radius: var(--border-radius);
            margin: 1rem 0;
        }

        /* Game Viewer App Styles & Collapsible Sections */
        :root {
            /* Map viewer colors to site variables */
            --viewer-bg: var(--surface-color, #1e1e1e);
            --viewer-sidebar: var(--background-color, #121212);
            --viewer-text: var(--text-color, #e0e0e0);
            --viewer-text-muted: var(--text-muted, #a0a0a0);
            --viewer-accent: var(--primary-color, #d4af37);
            --viewer-border: rgba(255, 255, 255, 0.1);
            --viewer-hover: rgba(255, 255, 255, 0.05);
            --viewer-active-bg: var(--primary-color, #d4af37);
            --viewer-active-text: var(--secondary-color, #1a1a1a);
        }

        /* Ensure header stays on top */
        header {
            z-index: 10000 !important;
        }

        .viewer-wrapper {
            margin: 2rem 0;
            border: 1px solid var(--viewer-border);
            border-radius: var(--border-radius);
            overflow: hidden;
            background: var(--viewer-bg);
            box-shadow: var(--shadow);
        }

        .article-content {
            font-size: 1.1rem;
            width: 100%;
            margin: 2rem 0;
            padding: 2rem;
            border: 1px solid var(--viewer-border);
            border-radius: var(--border-radius);
            overflow: hidden;
            background: var(--viewer-bg);
            box-shadow: var(--shadow);
            line-height: 1.8;
        }

        .viewer-toggle-bar {
            padding: 1rem 1.5rem;
            background: linear-gradient(135deg, var(--primary-color), #b8941f);
            color: var(--secondary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
            transition: background 0.3s;
        }

        .viewer-toggle-bar:hover {
            filter: brightness(110%);
        }

        .viewer-toggle-bar h3 {
            margin: 0;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--secondary-color);
            /* Ensure text is readable on gold */
            font-weight: 700;
        }

        /* Generic Collapsible Sections (for Reports) */
        .collapsible-wrapper {
            margin: 1.5rem 0;
            border: 1px solid var(--viewer-border);
            border-radius: var(--border-radius);
            overflow: hidden;
            background: var(--viewer-bg);
        }

        .collapsible-header {
            padding: 1rem 1.5rem;
            background-color: var(--viewer-sidebar);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
            border-bottom: 1px solid var(--viewer-border);
            transition: background 0.2s;
        }

        .collapsible-header:hover {
            background-color: var(--viewer-hover);
        }

        .collapsible-header h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        .collapsible-content {
            padding: 1.5rem;
            display: block;
            border-top: 1px solid var(--viewer-border);
        }

        .collapsible-content.hidden {
            display: none;
        }

        /* Report Styling */
        .highlight-name {
            font-weight: 700;
            color: var(--primary-color);
        }

        .highlight-score {
            font-weight: 700;
            color: #60a5fa;
            text-shadow: 0 0 10px rgba(96, 165, 250, 0.5);
        }

        /* Gallery Styles */
        .article-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .gallery-item {
            aspect-ratio: 1;
            overflow: hidden;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            background: var(--card-bg);
        }

        .gallery-item:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Lightbox */
        #lightbox {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 2rem;
        }

        #lightbox img {
            max-width: 90vw;
            max-height: 85vh;
            border-radius: 8px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
        }

        .lightbox-close {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 2.5rem;
            color: white;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }

        .lightbox-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 700px;
            background-color: var(--viewer-bg);
            color: var(--viewer-text);
            transition: height 0.3s ease-out;
        }

        .app-container.collapsed {
            height: 0;
            overflow: hidden;
        }

        .app-header {
            display: none;
            /* Hidden - adds no value */
        }

        .app-header h1 {
            font-size: 1.25rem;
            font-weight: 700;
            margin: 0;
            color: var(--primary-color);
            /* Match site heading color */
        }

        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 350px;
            background-color: var(--viewer-sidebar);
            border-right: 1px solid var(--viewer-border);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 1rem;
            border-bottom: 1px solid var(--viewer-border);
        }

        .sidebar-header h2 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--viewer-text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin: 0;
        }

        .game-list {
            padding: 0.75rem;
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .game-item {
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--viewer-text-muted);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
        }

        .game-item:hover {
            background-color: var(--viewer-hover);
            color: var(--viewer-text);
        }

        .game-item.active {
            background-color: var(--viewer-active-bg);
            color: var(--viewer-active-text);
            font-weight: 500;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .game-viewer {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 1.5rem;
            gap: 1rem;
            background-color: var(--viewer-bg);
            align-items: center;
            justify-content: center;
        }

        .iframe-container {
            width: 100%;
            max-width: 800px;
            aspect-ratio: 16/9;
            height: 480px;
            background-color: #000;
            border-radius: 0.75rem;
            overflow: hidden;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--viewer-border);
        }

        .iframe-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            width: 100%;
            max-width: 800px;
            justify-content: space-between;
            background-color: var(--viewer-sidebar);
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            border: 1px solid var(--viewer-border);
        }

        .control-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background-color: transparent;
            border: 1px solid var(--viewer-border);
            color: var(--viewer-text);
            padding: 0.4rem 0.8rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            font-size: 0.85rem;
        }

        .control-btn-viewer:hover:not(:disabled) {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .control-btn-viewer:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .current-game {
            font-weight: 600;
            font-size: 1rem;
            text-align: center;
        }

        .game-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            flex: 1;
            min-width: 0;
        }

        .current-game-title {
            font-weight: 600;
            font-size: 0.95rem;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }

        .game-counter {
            font-size: 0.75rem;
            color: var(--viewer-text-muted);
            background: rgba(255, 255, 255, 0.1);
            padding: 0.15rem 0.5rem;
            border-radius: 10px;
        }

        /* Mobile Responsive */
        @media (max-width: 900px) {
            .app-container {
                height: auto;
                min-height: 800px;
            }

            .main-content {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: 300px;
                order: 2;
                border-right: none;
                border-top: 1px solid var(--viewer-border);
            }

            .game-viewer {
                order: 1;
                width: 100%;
            }

            .iframe-container {
                width: 100%;
                height: 600px;
                aspect-ratio: auto;
            }

            /* Sticky controls on mobile */
            .controls {
                position: sticky;
                bottom: 0;
                z-index: 100;
                background: var(--viewer-sidebar);
                border-top: 1px solid var(--viewer-border);
                border-radius: 0;
                margin: 0;
                padding: 0.75rem 1rem;
                width: 100%;
                box-sizing: border-box;
            }

            /* Hide button text, show only icons on small screens */
            .btn-text {
                display: none;
            }

            .control-btn {
                padding: 0.6rem 0.8rem;
            }

            .current-game-title {
                font-size: 0.85rem;
            }

            .game-counter {
                font-size: 0.7rem;
            }

            /* More compact iframe */
            .iframe-container {
                height: 550px;
            }

            /* Smaller game list */
            .sidebar {
                height: 200px;
            }

            .game-viewer {
                padding: 0.75rem;
                gap: 0.5rem;
            }
        }
    </style>
    <link rel="icon" type="image/png" href="images/favicon.png">
</head>

<body>
    <header id="global-header"></header>

    <main>
        <section class="container" style="margin-top: 80px;">
            <div id="loading" style="text-align: center; padding: 4rem;">
                <div
                    style="display: inline-block; width: 40px; height: 40px; border: 4px solid rgba(212, 175, 55, 0.2); border-radius: 50%; border-top-color: var(--primary-color); animation: spin 1s linear infinite;">
                </div>
                <p style="margin-top: 1rem; color: var(--text-muted);">Na캜칤t치n칤 캜l치nku...</p>
            </div>

            <article id="article" class="hidden">
                <!-- Compact Header Row: Nav + Meta -->
                <div
                    style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border-color); font-size: 0.9rem;">
                    <!-- Navigation -->
                    <div style="display: flex; gap: 1.5rem;">
                        <a id="prevArticleLink" href=""
                            style="display: none; align-items: center; gap: 0.5rem; color: var(--text-muted);">
                            <i class="fa-solid fa-arrow-left"></i> <span id="prevArticleTitle">P콏edchoz칤</span>
                        </a>
                        <a id="nextArticleLink" href=""
                            style="display: none; align-items: center; gap: 0.5rem; color: var(--text-muted);">
                            <span id="nextArticleTitle">Dal코칤</span> <i class="fa-solid fa-arrow-right"></i>
                        </a>
                    </div>
                    <!-- Meta -->
                    <div style="display: flex; gap: 1.5rem; color: var(--text-muted);">
                        <span id="articleDate"><i class="fa-regular fa-calendar"></i> </span>
                        <span id="articleCategory"><i class="fa-solid fa-tag"></i> </span>
                    </div>
                </div>

                <h1 id="articleTitle" style="font-size: 2.25rem; margin-bottom: 1.5rem;"></h1>

                <div class="article-content" id="articleBody"></div>

                <!-- Games Section -->
                <!-- Games Section - App Style -->
                <div id="game-viewer-container" class="viewer-wrapper hidden" style="margin-top: 3rem;">
                    <div class="viewer-toggle-bar" onclick="toggleViewer()">
                        <h3><i class="fa-solid fa-chess-board"></i> P콏ehr치va캜 parti칤</h3>
                        <i id="viewerToggleIcon" class="fa-solid fa-chevron-up"></i>
                    </div>
                    <div id="appContainer" class="app-container">
                        <header class="app-header">
                            <div>
                                <h1 id="gameViewerTitle">Partie</h1>
                                <p id="gameViewerSubtitle"
                                    style="color: var(--viewer-text-muted); font-size: 0.8rem; margin: 0;"></p>
                            </div>
                        </header>

                        <main class="main-content">
                            <aside class="sidebar">
                                <div class="sidebar-header">
                                    <h2>Seznam Parti칤</h2>
                                </div>
                                <div class="game-list" id="game-list-content">
                                    <!-- Games will be populated here -->
                                </div>
                            </aside>

                            <section class="game-viewer">
                                <div class="iframe-container">
                                    <iframe id="chess-frame" src="" frameborder="0" allowtransparency="true"></iframe>
                                </div>
                                <div class="controls">
                                    <button id="prevBtn" class="control-btn" onclick="prevGame()"
                                        aria-label="P콏edchoz칤 partie">
                                        <i class="fa-solid fa-chevron-left"></i> <span class="btn-text">P콏edchoz칤</span>
                                    </button>
                                    <div class="game-info">
                                        <span id="current-game-title" class="current-game-title">Vyberte partii</span>
                                        <span id="game-counter" class="game-counter"></span>
                                    </div>
                                    <button id="nextBtn" class="control-btn" onclick="nextGame()"
                                        aria-label="Dal코칤 partie">
                                        <span class="btn-text">Dal코칤</span> <i class="fa-solid fa-chevron-right"></i>
                                    </button>
                                </div>
                            </section>
                        </main>
                    </div>
                </div>

                <!-- Gallery Section -->
                <div id="gallerySection" class="hidden" style="margin-top: 3rem;">
                    <h2 style="color: var(--primary-color); margin-bottom: 1.5rem;"><i class="fa-solid fa-images"></i>
                        Fotogalerie</h2>
                    <div id="galleryGrid" class="article-gallery"></div>
                </div>
            </article>

            <div id="error" class="hidden" style="text-align: center; padding: 4rem;">
                <i class="fa-solid fa-exclamation-triangle" style="font-size: 3rem; color: #fca5a5;"></i>
                <p style="margin-top: 1rem; color: var(--text-muted);">캛l치nek nebyl nalezen.</p>
                <a href="/" class="btn-primary" style="margin-top: 1rem; display: inline-block;">Zp캩t na
                    칰vod</a>
            </div>
        </section>
    </main>

    <footer id="global-footer"></footer>

    <script src="js/config.js"></script>
    <script src="js/layout-loader.js"></script>
    <script src="js/lightbox.js"></script>
    <script src="js/main.js"></script>
    <script>
        // Article Loader
        document.addEventListener('DOMContentLoaded', async () => {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');

            if (!id) {
                showError();
                return;
            }

            try {
                const res = await fetch(`${API_URL}/news/${id}`);
                if (!res.ok) throw new Error('Not found');

                const article = await res.json();
                renderArticle(article);
            } catch (e) {
                console.error(e);
                showError();
            }
        });

        function renderArticle(article) {
            document.title = `${article.title} - 마chov칳 odd칤l TJ Bi쬿terie Jablonec`;

            // Navigation Links
            const prevLink = document.getElementById('prevArticleLink');
            const nextLink = document.getElementById('nextArticleLink');

            // Truncate title for mobile nav
            const truncateTitle = (title, maxLen = 20) =>
                title.length > maxLen ? title.slice(0, maxLen) + '...' : title;

            if (article.prevArticle) {
                prevLink.href = `article.html?id=${article.prevArticle.id}`;
                document.getElementById('prevArticleTitle').textContent = truncateTitle(article.prevArticle.title);
                prevLink.style.display = 'flex';
                prevLink.title = article.prevArticle.title;
            } else {
                prevLink.style.display = 'none';
            }

            if (article.nextArticle) {
                nextLink.href = `article.html?id=${article.nextArticle.id}`;
                document.getElementById('nextArticleTitle').textContent = truncateTitle(article.nextArticle.title);
                nextLink.style.display = 'flex';
                nextLink.title = article.nextArticle.title;
            } else {
                nextLink.style.display = 'none';
            }

            // Article Content
            document.getElementById('articleTitle').textContent = article.title;
            document.getElementById('articleDate').innerHTML = `<i class="fa-regular fa-calendar"></i> ${new Date(article.publishedDate).toLocaleDateString('cs-CZ')}`;
            document.getElementById('articleCategory').innerHTML = `<i class="fa-solid fa-tag"></i> ${article.category}`;
            document.getElementById('articleBody').innerHTML = article.content || '';

            // Handle Games
            if (article.gamesJson && article.gamesJson !== '[]' && article.gamesJson !== 'null') {
                try {
                    const games = JSON.parse(article.gamesJson);
                    if (games && games.length > 0) {
                        renderGames(games, article.teamsJson ? JSON.parse(article.teamsJson) : null);
                    }
                } catch (e) {
                    console.log('No games data');
                }
            }

            // Handle Gallery
            if (article.galleryJson) {
                const images = JSON.parse(article.galleryJson);
                if (images.length > 0) {
                    renderGallery(images);
                }
            }

            document.getElementById('loading').style.display = 'none';
            document.getElementById('article').classList.remove('hidden');
            document.getElementById('error').classList.add('hidden');
        }

        function renderGames(games, teams) {
            gamesData = games;
            teamsData = teams;
            const container = document.getElementById('game-viewer-container');
            const list = document.getElementById('game-list-content');
            const title = document.getElementById('gameViewerTitle');
            const subtitle = document.getElementById('gameViewerSubtitle');

            if (!games || games.length === 0) {
                container.classList.add('hidden');
                return;
            }

            container.classList.remove('hidden');

            if (teams && teams.length >= 2) {
                // Determine logic for title? For now keep simple
                title.textContent = `${teams[0].name} vs ${teams[1].name}`;
                subtitle.textContent = "Rozbor parti칤";
            }

            list.innerHTML = '';
            let currentLegacyTeam = null;

            games.forEach((game, index) => {
                // Logic to render headers
                // 1. Explicit Headers (New system)
                if (game.type === 'header' || game.isHeader) {
                    const header = document.createElement('div');
                    header.className = 'team-header';
                    header.textContent = game.title;
                    header.style.cssText = 'padding: 0.5rem 0.75rem; font-weight: 700; color: var(--primary-color); background: rgba(255, 255, 255, 0.05); border-left: 2px solid var(--primary-color); margin: 0.5rem 0 0.25rem 0; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em;';
                    list.appendChild(header);
                    return; // It's just a visual separator, not a playable game
                }

                const item = document.createElement('div');
                item.className = 'game-item';
                item.textContent = game.title;
                item.dataset.index = index; // Store index for mapping

                if (game.commented) {
                    item.innerHTML += '&nbsp;游눫';
                    item.title = 'Okomentov치no';
                }

                item.onclick = () => loadGame(index);
                list.appendChild(item);
            });

            // Load first game
            if (games.length > 0) {
                loadGame(0);
            }
        }

        function loadGame(index) {
            if (index < 0 || index >= gamesData.length) return;
            const game = gamesData[index];
            if (game.type === 'header' || game.isHeader) return; // Cannot load a header
            currentGameIndex = index;

            document.getElementById('current-game-title').textContent = game.title;

            // Count only playable games (not headers)
            const playableGames = gamesData.filter(g => g.type !== 'header' && !g.isHeader);
            const currentNum = playableGames.indexOf(game) + 1;
            document.getElementById('game-counter').textContent = `${currentNum} / ${playableGames.length}`;

            let src = game.gameId || game.chessComId;
            if (src && !src.startsWith('http')) {
                src = `https://www.chess.com/emboard?id=${src}`;
            }
            // Fallback to game.src if gameId/chessComId missing
            if (!src && game.src) src = game.src;

            document.getElementById('chess-frame').src = src || '';

            // Re-query strictly game items and highlight active
            const gameItems = document.querySelectorAll('.game-item');
            gameItems.forEach((item) => {
                if (parseInt(item.dataset.index) === index) {
                    item.classList.add('active');
                    item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                } else {
                    item.classList.remove('active');
                }
            });

            // Update buttons
            document.getElementById('prevBtn').disabled = (index === 0);
            document.getElementById('nextBtn').disabled = (index === gamesData.length - 1);
        }

        function prevGame() {
            loadGame(currentGameIndex - 1);
        }

        function nextGame() {
            loadGame(currentGameIndex + 1);
        }

        // Keyboard navigation for game viewer
        document.addEventListener('keydown', function (e) {
            const viewer = document.getElementById('game-viewer-container');
            if (!viewer || viewer.classList.contains('hidden')) return;

            // Check if viewer is visible on screen
            const rect = viewer.getBoundingClientRect();
            const isVisible = rect.top < window.innerHeight && rect.bottom > 0;
            if (!isVisible) return;

            // Don't trigger if user is typing in an input
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

            if (e.key === 'ArrowLeft') {
                e.preventDefault();
                prevGame();
            } else if (e.key === 'ArrowRight') {
                e.preventDefault();
                nextGame();
            }
        });

        // Swipe gestures for mobile
        let touchStartX = 0;
        let touchEndX = 0;

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) < swipeThreshold) return;

            if (diff > 0) {
                // Swipe left = next
                nextGame();
            } else {
                // Swipe right = prev
                prevGame();
            }
        }

        // Attach to game viewer section
        document.addEventListener('DOMContentLoaded', function () {
            const gameViewer = document.querySelector('.game-viewer');
            if (!gameViewer) return;

            gameViewer.addEventListener('touchstart', function (e) {
                touchStartX = e.changedTouches[0].screenX;
            }, { passive: true });

            gameViewer.addEventListener('touchend', function (e) {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            }, { passive: true });
        });

        function toggleViewer() {
            const container = document.getElementById('appContainer');
            const icon = document.getElementById('viewerToggleIcon');

            if (container.classList.contains('collapsed')) {
                container.classList.remove('collapsed');
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            } else {
                container.classList.add('collapsed');
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            }
        }

        // Generic Toggle for Reports (or any section)
        window.toggleSection = function (id, iconId) {
            const content = document.getElementById(id);
            const icon = document.getElementById(iconId);

            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                if (icon) {
                    icon.classList.remove('fa-chevron-down');
                    icon.classList.add('fa-chevron-up');
                }
            } else {
                content.classList.add('hidden');
                if (icon) {
                    icon.classList.remove('fa-chevron-up');
                    icon.classList.add('fa-chevron-down');
                }
            }
        }

        let articleGalleryImages = [];

        function renderGallery(images) {
            const container = document.getElementById('gallerySection');
            if (!images || images.length === 0) {
                container.classList.add('hidden');
                return;
            }
            articleGalleryImages = images;
            container.classList.remove('hidden');
            document.getElementById('galleryGrid').innerHTML = images.map((img, index) => `
                <div class="gallery-item" onclick="SJLightbox.open(articleGalleryImages, ${index})">
                    <img src="${img}" loading="lazy">
                </div>
            `).join('');
        }

        function showError() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('article').classList.add('hidden');
            document.getElementById('error').classList.remove('hidden');
        }

        // Add spinner animation style
        const style = document.createElement('style');
        style.textContent = `
            @keyframes spin { to { transform: rotate(360deg); } }
        `;
        document.head.appendChild(style);
    </script>
</body>

</html>